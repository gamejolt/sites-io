!function(e,t){"use strict";function i(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function n(e,t,i,n){var o,a=arguments.length,r=3>a?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(r=(3>a?o(r):a>3?o(t,i,r):o(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r}function o(e,t){return function(i,n){t(i,n,e)}}function a(e,t){return f.$q=e,f.Api=t,f}function r(e,t,i){return e.create(it,{SiteTheme:t,SiteContentBlock:i})}function s(e){return e.create(at,{})}function l(e){return e.create(st,{})}function d(e,t){return e.create(dt,{SiteTemplate:t})}a.$inject=["$q","Api"],r.$inject=["Model","SiteTheme","SiteContentBlock"],s.$inject=["Model"],l.$inject=["Model"],d.$inject=["Model","SiteTemplate"];var c="undefined"!=typeof global&&"object"==typeof process,u=window&&"https:"===window.location.protocol,p=window&&-1!==window.navigator.userAgent.search(/PhantomJS/),h=function(){function e(e){this.env="production",this.buildType="production",this.isClient=c,this.isSecure=u,this.isPrerender=p,this.baseUrl="http://gamejolt.com",this.secureBaseUrl="https://gamejolt.com",this.wttfBaseUrl="http://gamejolt.com",this.authBaseUrl="https://gamejolt.com",this.checkoutBaseUrl="https://gamejolt.com",this.jamsBaseUrl="http://jams.gamejolt.com",this.jamsIoBaseUrl="http://jams.gamejolt.io",this.firesideBaseUrl="http://fireside.gamejolt.com",this.helpBaseUrl="https://help.gamejolt.com",this.devBaseUrl="http://dev.gamejolt.com",this.gameserverUrl="http://gamejolt.net/gameserver",this.mediaserverUrl="https://p5b4y2t6.ssl.hwcdn.net",this.apiHost="https://gamejolt.com",this.activityStreamHost="https://activity.gamejolt.com",this.chatHost="https://chat.gamejolt.com",this.widgetHost="https://widgets.gamejolt.com","development"===this.env&&(this.baseUrl="http://development.gamejolt.com",this.secureBaseUrl="http://development.gamejolt.com",this.wttfBaseUrl="http://development.gamejolt.com",this.authBaseUrl="http://development.gamejolt.com",this.checkoutBaseUrl="http://development.gamejolt.com",this.jamsBaseUrl="http://jams.development.gamejolt.com",this.jamsIoBaseUrl="http://jams.development.gamejolt.io",this.firesideBaseUrl="http://fireside.development.gamejolt.com",this.helpBaseUrl="http://help.development.gamejolt.com",this.devBaseUrl="http://dev.development.gamejolt.com",this.gameserverUrl="http://development.gamejolt.net/gameserver",this.mediaserverUrl="http://media.development.gamejolt.com",this.apiHost="http://development.gamejolt.com",this.activityStreamHost="http://activity.development.gamejolt.com",this.chatHost="http://chat.development.gamejolt.com",this.widgetHost="http://localhost:8081"),this.isClient&&(-1!==window.location.href.search(/^app\:\/\/game\-jolt\-client\/package\//)?(this.wttfBaseUrl="app://game-jolt-client/package/index.html#!",this.authBaseUrl="app://game-jolt-client/package/auth.html#!",this.checkoutBaseUrl="app://game-jolt-client/package/checkout.html#!"):(this.wttfBaseUrl="app://game-jolt-client/index.html#!",this.authBaseUrl="app://game-jolt-client/auth.html#!",this.checkoutBaseUrl="app://game-jolt-client/checkout.html#!")),this.isPrerender&&e.enabled(!1)}return e}();h=n([t.Injectable(),o(0,t.Inject("$animate"))],h);var m,g=(m=angular.module("gj.Environment",[])).service.apply(m,t.provide("Environment",{useClass:h})).name,f=v=function(){function e(e){e&&angular.extend(this,e)}return e.create=function(e,t){if(e.populate=function(t){var i=[];if(t&&angular.isArray(t)&&t.length)for(var n=0,o=t;n<o.length;n++){var a=o[n];i.push(new e(a))}return i},e.prototype.assign=function(t){var i=new e(t);angular.extend(this,i)},angular.extend(e.prototype,v.prototype),t)for(var i in t)e[i]=t[i];return e},e.processCreate=function(e,t){return e.success&&e[t]?v.$q.resolve(e):v.$q.reject(e)},e.prototype.processUpdate=function(e,t){return e.success&&e[t]?(this.assign(e[t]),v.$q.resolve(e)):v.$q.reject(e)},e.prototype.processRemove=function(e){return e.success?(this._removed=!0,v.$q.resolve(e)):v.$q.reject(e)},e.prototype.$_save=function(e,t,i){var n=this;return v.Api.sendRequest(e,this,i).then(function(e){return n.processUpdate(e,t)})},e.prototype.$_remove=function(e,t){var i=this;return v.Api.sendRequest(e,{},t).then(function(e){return i.processRemove(e)})},e}();f=v=n([t.Injectable()],f);var v,y=angular.module("gj.Model",[]).factory("Model",a).name,b=function(){function e(){}return e}(),w=function(){function e(e){this._document=e,this._fields={},this._head=this._document.head}return e.prototype._set=function(e,t){this._storeField(e,t);var i=this._head.querySelector('meta[name="'+e+'"]');return t?(i||(i=this._document.createElement("meta"),i.name=e,this._head.appendChild(i)),void(i.content=t)):void(i&&this._head.removeChild(i))},e.prototype._get=function(e){return this._fields[e]?this._fields[e].current:null},e.prototype._storeField=function(e,t){if(!this._fields[e]){var i=new b,n=this._head.querySelector('meta[name="'+e+'"]');n&&(i.original=n.content),this._fields[e]=i}this._fields[e].current=t},e}(),j=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this._get("og:title")},set:function(e){this._set("og:title",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._get("og:description")},set:function(e){this._set("og:description",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._get("og:url")},set:function(e){this._set("og:url",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._get("og:type")},set:function(e){this._set("og:type",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._get("og:image")},set:function(e){this._set("og:image",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"profileId",{get:function(){return this._get("og:profile_id")},set:function(e){this._set("og:profile_id",e)},enumerable:!0,configurable:!0}),t}(w),$=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"card",{get:function(){return this._get("twitter:card")},set:function(e){this._set("twitter:card",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._get("twitter:title")},set:function(e){this._set("twitter:title",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._get("twitter:description")},set:function(e){this._set("twitter:description",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this._get("twitter:image")},set:function(e){this._set("twitter:image",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._get("twitter:url")},set:function(e){this._set("twitter:url",e)},enumerable:!0,configurable:!0}),t}(w),S=function(){function e(e){this._document=e,this._head=this._document.head}return e.prototype.set=function(e){var t=this._head.querySelector('script[type="application/ld+json"]');t&&this.clear(),t=this._document.createElement("script"),t.type="application/ld+json",t.text=JSON.stringify(e),this._head.appendChild(t)},e.prototype.clear=function(){var e=this._head.querySelector('script[type="application/ld+json"]');e&&this._head.removeChild(e)},e}(),E=function(e){function t(t,i,n){var o=e.call(this,i[0])||this;return o.$document=i,o.Environment=n,o._originalTitle=o.$document[0].title,o._fb=new j(o.$document[0]),o._twitter=new $(o.$document[0]),o._microdata=new S(o.$document[0]),o.clear(),t.$on("$stateChangeSuccess",function(){o.clear()}),o}return i(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.$document[0].title},set:function(e){e?e+=this.Environment.isClient?" - Game Jolt":" on Game Jolt":e=this._originalTitle,this.$document[0].title=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._get("description")},set:function(e){this._set("description",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redirect",{get:function(){return this._get("redirect")},set:function(e){this._set("redirect",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"responseCode",{get:function(){return this._get("responseCode")},set:function(e){this._set("responseCode",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fb",{get:function(){return this._fb},set:function(e){angular.merge(this._fb,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"twitter",{get:function(){return this._twitter},set:function(e){angular.merge(this._twitter,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"microdata",{set:function(e){this._microdata.set(e)},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.description=null,this.redirect=null,this.responseCode=null,this.fb={title:null,description:null,url:null,type:null,image:null,profileId:null},this.twitter={title:null,description:null,card:null,image:null,url:null,shareMessage:null},this._microdata.clear()},t}(w);E=n([t.Injectable(),o(0,t.Inject("$rootScope")),o(1,t.Inject("$document")),o(2,t.Inject("Environment"))],E);var I,k=(I=angular.module("gj.Meta",[])).service.apply(I,t.provide("Meta",{useClass:E})).name,x=/^(none|table(?!-c[ea]).+)/,T={position:"absolute",visibility:"hidden",display:"block"},P=function(){function e(){}return e.prototype.width=function(e){return this._dimensions("clientWidth",e)},e.prototype.height=function(e){return this._dimensions("clientHeight",e)},e.prototype.outerWidth=function(e){return this._dimensions("offsetWidth",e)},e.prototype.outerHeight=function(e){return this._dimensions("offsetHeight",e)},e.prototype._dimensions=function(e,t){var i;i=t===window.document?window.document.body:t;var n=window.getComputedStyle(i),o=!1,a={};if(x.test(n.display||"")&&0===i.offsetWidth){o=!0;for(var r in T)a[r]=i.style[r],i.style[r]=T[r]}var s=i[e];if("clientWidth"===e?s-=parseFloat(n.paddingLeft||"")+parseFloat(n.paddingRight||""):"clientHeight"===e?s-=parseFloat(n.paddingTop||"")+parseFloat(n.paddingBottom||""):"offsetWidth"===e?s+=parseFloat(n.marginLeft||"")+parseFloat(n.marginRight||""):"offsetHeight"===e&&(s+=parseFloat(n.marginTop||"")+parseFloat(n.marginBottom||"")),o)for(var r in T)i.style[r]=a[r];return s},e}();P=n([t.Injectable()],P);var C,A=(C=angular.module("gj.Ruler",[])).service.apply(C,t.provide("Ruler",{useClass:P})).name,M=768,O=992,R=1200,B=1.5,L=function(){function e(e,t){var i=this;this.$rootScope=e,this.$window=t,this.width=0,this.windowWidth=0,this.height=0,this.windowHeight=0,this.isXs=!1,this.isSm=!1,this.isMd=!0,this.isLg=!1,this.breakpoint="md",this.isWindowXs=this.isXs,this.isWindowSm=this.isSm,this.isWindowMd=this.isMd,this.isWindowLg=this.isLg,this.windowBreakpoint="md",this.isMobile=!1,this.isDesktop=!0,this.isWindowMobile=this.isMobile,this.isWindowDesktop=this.isDesktop,this.context=null,this.isHiDpi=!1,this._generateMq(),this.isHiDpi=this.mq("only screen and (-webkit-min-device-pixel-ratio: "+B+"), only screen and (min--moz-device-pixel-ratio: "+B+"), only screen and (-o-min-device-pixel-ratio: "+B+" / 1), only screen and (min-resolution: "+B+"dppx), only screen and (min-resolution: "+96*B+"dpi)"),this._onResize(),angular.element(t).on("resize",_.debounce(function(){e.$apply(function(){i._onResize()})},250))}return e.prototype._generateMq=function(){var e=this.$window,t=e.matchMedia||e.msMatchMedia;if(t)this.mq=function(e){return t(e)&&t(e).matches||!1};else{var i=e.styleMedia||e.media;if(!i){var n=e.document.createElement("style"),o=e.document.getElementsByTagName("script")[0];n.type="text/css",n.id="matchmediajs-test",o.parentNode.insertBefore(n,o);var a="getComputedStyle"in e&&e.getComputedStyle(n,null)||n.currentStyle;i={matchMedium:function(e){var t="@media "+e+"{ #matchmediajs-test { width: 1px; } }";return n.styleSheet?n.styleSheet.cssText=t:n.textContent=t,"1px"===a.width}}}this.mq=function(e){return i.matchMedium(e||"all")||!1}}},e.prototype.setContext=function(e){this.context=e?e[0]:null},e.prototype.setResizeSpy=function(e,t){var i=this.$rootScope.$on("Screen.onResize",function(){t()});e.$on("$destroy",function(){i()})},e.prototype.recalculate=function(){this._onResize()},e.prototype._onResize=function(){this.mq("only screen and (max-width: "+(M-1)+"px)")?(this.isWindowXs=!0,this.isWindowSm=!1,this.isWindowMd=!1,this.isWindowLg=!1,this.windowBreakpoint="xs"):this.mq("only screen and (min-width: "+M+"px) and (max-width: "+(O-1)+"px)")?(this.isWindowXs=!1,this.isWindowSm=!0,this.isWindowMd=!1,this.isWindowLg=!1,this.windowBreakpoint="sm"):this.mq("only screen and (min-width: "+O+"px) and (max-width: "+(R-1)+"px)")?(this.isWindowXs=!1,this.isWindowSm=!1,this.isWindowMd=!0,this.isWindowLg=!1,this.windowBreakpoint="md"):this.mq("only screen and (min-width: "+R+"px)")&&(this.isWindowXs=!1,this.isWindowSm=!1,this.isWindowMd=!1,this.isWindowLg=!0,this.windowBreakpoint="lg"),this.isWindowXs||this.isWindowSm?(this.isWindowMobile=!0,this.isWindowDesktop=!1):(this.isWindowMobile=!1,this.isWindowDesktop=!0),this.windowWidth=this.$window.innerWidth>0?this.$window.innerWidth:this.$window.width,this.windowHeight=this.$window.innerHeight>0?this.$window.innerHeight:this.$window.height,this.context?(this.width=this.context.clientWidth,this.height=this.context.clientHeight,this.width<M?(this.isXs=!0,this.isSm=!1,this.isMd=!1,this.isLg=!1,this.breakpoint="xs"):this.width>=M&&this.width<O?(this.isXs=!1,this.isSm=!0,this.isMd=!1,this.isLg=!1,this.breakpoint="sm"):this.width>=O&&this.width<R?(this.isXs=!1,this.isSm=!1,this.isMd=!0,this.isLg=!1,this.breakpoint="md"):this.width>=R&&(this.isXs=!1,this.isSm=!1,this.isMd=!1,this.isLg=!0,this.breakpoint="lg"),this.isXs||this.isSm?(this.isMobile=!0,this.isDesktop=!1):(this.isMobile=!1,this.isDesktop=!0)):(this.isXs=this.isWindowXs,this.isSm=this.isWindowSm,this.isMd=this.isWindowMd,this.isLg=this.isWindowLg,this.isMobile=this.isWindowMobile,this.isDesktop=this.isWindowDesktop,this.width=this.windowWidth,this.height=this.windowHeight,this.breakpoint=this.windowBreakpoint),this.$rootScope.$emit("Screen.onResize",this)},e}();L=n([t.Injectable(),o(0,t.Inject("$rootScope")),o(1,t.Inject("$window"))],L);var D,U=(D=angular.module("gj.Screen",[])).service.apply(D,t.provide("Screen",{useClass:L})).name,G=function(){function e(e,t){this.$document=e,this.$q=t}return e.prototype.loaded=function(e){var t=this;return new this.$q(function(i,n){var o=t.$document[0].createElement("img");o.onload=i,o.onerror=n,o.src=e})},e.prototype.getResizedDimensions=function(e,t,i,n){var o,a,r=t/e;if(i&&n)o=Math.min(e,i),a=o*r,a>n&&(a=n,o=a/r);else if(i&&!n)o=Math.min(e,i),a=o*r;else{if(i||!n)throw new Error("Invalid params.");a=Math.min(t,n),o=a/r}return{width:o,height:a}},e}();G=n([t.Injectable(),o(0,t.Inject("$document")),o(1,t.Inject("$q"))],G);var W,F=(W=angular.module("gj.Img.Helper",[])).service.apply(W,t.provide("ImgHelper",{useClass:G})).name,H=/\/(\d+)x(\d+)\//,N=/\/(\d+)\//,q=function(){function e(e,t,i,n,o){var a=this;this.$scope=t,this.screen=i,this.ruler=n,this.imgHelper=o,this.element=e[0],this.element.classList.add("img-responsive"),i.setResizeSpy(t,function(){return a.updateSrc()})}return e.prototype.ngOnChanges=function(e){e.startSrc&&this.updateSrc()},e.prototype.updateSrc=function(){var e=this;this.$scope.$applyAsync(function(){var t=e.ruler.width(e.element.parentNode);if(!(0>=t)){var i=e.startSrc,n=t;e.screen.isHiDpi?(n=2*n,n=100*Math.ceil(n/100)):n=100*Math.ceil(n/100),i=-1!==i.search(H)?i.replace(H,"/"+n+"x2000/"):i.replace(N,"/"+n+"/"),i!=e.element.src&&(e.element.src=i,e.onLoadedChange&&(e.onLoadedChange({$loaded:!1}),e.imgHelper.loaded(i).then(function(){return e.onLoadedChange({$loaded:!0})})))}})},e}();n([t.Input("@gjImgResponsive")],q.prototype,"startSrc",void 0),n([t.Output()],q.prototype,"onLoadedChange",void 0),q=n([t.Directive({selector:"[gj-img-responsive]"}),o(0,t.Inject("$element")),o(1,t.Inject("$scope")),o(2,t.Inject("Screen")),o(3,t.Inject("Ruler")),o(4,t.Inject("ImgHelper"))],q);var V,z=(V=angular.module("gj.Img.ImgResponsive",["gj.Screen","gj.Ruler",F])).directive.apply(V,t.provide(q)).name,Y='<div class="video-embed">\n	<div class="video-embed-inner">\n\n		<iframe nwdisable nwfaketop\n			type="text/html" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen\n			ng-if="$ctrl.videoProvider == \'youtube\' && $ctrl.embedUrl"\n			width="{{ $ctrl.width }}" height="{{ $ctrl.height }}"\n			ng-src="{{ $ctrl.embedUrl }}"></iframe>\n\n		<iframe nwdisable nwfaketop\n			frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen\n			ng-if="$ctrl.videoProvider == \'vimeo\' && $ctrl.embedUrl"\n			width="{{ $ctrl.width }}" height="{{ $ctrl.height }}"\n			ng-src="{{ $ctrl.embedUrl }}"></iframe>\n\n	</div>\n</div>\n',X=.5625,K=function(){function e(e,t,i,n,o,a){var r=this;this.$element=t,this.$sce=i,this.$timeout=n,this.ruler=a,this.autoplay=!1,this.$timeout(function(){return r.recalculateDimensions()}),o.setResizeSpy(e,function(){r.$timeout(function(){return r.recalculateDimensions()})})}return e.prototype.ngOnChanges=function(e){var t;if(e.videoId){if("youtube"==this.videoProvider)t="https://www.youtube.com/embed/"+this.videoId;else{if("vimeo"!=this.videoProvider)throw new Error("Invalid video provider.");t="https://player.vimeo.com/video/"+this.videoId}this.autoplay&&(t+="?autoplay=1"),this.embedUrl=this.$sce.trustAsResourceUrl(t)}},e.prototype.recalculateDimensions=function(){this.width=this.ruler.width(this.$element[0].getElementsByClassName("video-embed-inner")[0]),this.maxVideoWidth&&(this.width=Math.min(this.maxVideoWidth,this.width)),this.height=this.width*X,this.maxVideoHeight&&this.height>this.maxVideoHeight&&(this.height=this.maxVideoHeight,this.width=this.height/X)},e}();n([t.Input("@")],K.prototype,"videoProvider",void 0),n([t.Input("<")],K.prototype,"videoId",void 0),n([t.Input("<?")],K.prototype,"maxVideoHeight",void 0),n([t.Input("<?")],K.prototype,"maxVideoWidth",void 0),n([t.Input("<?")],K.prototype,"autoplay",void 0),K=n([t.Component({selector:"gj-video-embed",template:Y}),o(0,t.Inject("$scope")),o(1,t.Inject("$element")),o(2,t.Inject("$sce")),o(3,t.Inject("$timeout")),o(4,t.Inject("Screen")),o(5,t.Inject("Ruler"))],K);var J,Z=(J=angular.module("gj.Video.Embed",[])).directive.apply(J,t.provide(K)).name,Q='<div section class="section fill-darker media-bar scrollable scrollable-x overlay-scrollbar"\n	ng-class="{ \'is-loading\': !$ctrl.mediaItems }"\n	>\n	<div class="media-bar-items">\n\n		<div class="loading-container" ng-if="!$ctrl.mediaItems">\n			<gj-loading class="loading-centered" loading-no-color loading-stationary hide-label></gj-loading>\n		</div>\n\n		<div ng-if="$ctrl.mediaItems">\n			<gj-media-bar-item ng-repeat="item in $ctrl.mediaItems track by item.id" item="item"></gj-media-bar-item>\n		</div>\n\n	</div>\n</div>\n\n<!--\n	We don\'t show lightbox on mobile.\n	The media bar by itself already shows images larger than the lightbox will show.\n-->\n<div oc-lazy-load="{ files: [ \'/app/modules/hammer.js\' ] }">\n	<gj-media-bar-lightbox\n		ng-if="$ctrl.activeItem && !$ctrl.screen.isXs"\n		>\n	</gj-media-bar-lightbox>\n</div>\n',ee=function(){function e(e,t){this.$location=e,this.screen=t,this._urlChecked=!1,this.activeItem=null,this.activeIndex=null,this.isPlaying=null}return e.prototype.ngOnChanges=function(e){e.mediaItems&&angular.isDefined(this.mediaItems)&&!this._urlChecked&&this._checkUrl()},e.prototype.setActiveItem=function(e){var t=e;angular.isObject(e)&&(t=_.findIndex(this.mediaItems,{id:e.id})),this.go(t)},e.prototype.goNext=function(){this.go(Math.min(this.mediaItems.length-1,this.activeIndex+1))},e.prototype.goPrev=function(){this.go(Math.max(0,this.activeIndex-1))},e.prototype.go=function(e){this.activeIndex=e,this.activeItem=this.mediaItems[this.activeIndex],this.isPlaying=this.activeIndex},e.prototype.clearActiveItem=function(){this.activeItem=null,this.activeIndex=null,this.isPlaying=null},e.prototype._checkUrl=function(){this._urlChecked=!0;var e,t=this.$location.hash();if(t){var i=void 0;if(-1!==t.indexOf("screenshot-")?(e=parseInt(t.substring("screenshot-".length)),i="image"):-1!==t.indexOf("video-")&&(e=parseInt(t.substring("video-".length)),i="video"),e&&i){var n=_.find(this.mediaItems,{id:e});n&&this.setActiveItem(n)}}},e}();n([t.Input("<")],ee.prototype,"mediaItems",void 0),ee=n([t.Component({selector:"gj-media-bar",template:Q}),o(0,t.Inject("$location")),o(1,t.Inject("Screen"))],ee);var te='<a class="media-bar-item-wrapper" ng-click="$ctrl.onClick()">\n\n	<img\n		gj-img-responsive="{{ ::$ctrl.item.img_thumbnail }}"\n		on-loaded-change="$ctrl.onLoadedChange( $loaded )"\n		title="{{ ::$ctrl.item.media_type == \'image\' ? $ctrl.item.caption : $ctrl.item.title }}"\n		alt="{{ ::$ctrl.item.media_type == \'image\' ? $ctrl.item.caption : $ctrl.item.title }}">\n\n	<span class="play-button-overlay" ng-if="$ctrl.item.media_type == \'video\'">\n		<span class="jolticon jolticon-play"></span>\n	</span>\n\n</a>\n',ie=function(){function e(e,t,i){this.$element=e,this.screen=t,this.mediaBar=i,this.$element[0].classList.add("media-bar-item")}return e.prototype.ngOnInit=function(){if(this.elem=this.$element[0],"image"==this.item.media_type){var e=this.item.media_item.getDimensions(400,150);this.elem.style.width=e.width+"px",this.elem.style.height=e.height+"px"}else this.elem.style.width="200px"},e.prototype.onLoadedChange=function(e){e?this.elem.classList.add("loaded"):this.elem.classList.remove("loaded")},e.prototype.onClick=function(){this.screen.isXs||this.mediaBar.setActiveItem(this.item)},e}();n([t.Input("<")],ie.prototype,"item",void 0),ie=n([t.Component({selector:"gj-media-bar-item",template:te}),o(0,t.Inject("$element")),o(1,t.Inject("Screen")),o(2,t.Inject(ee)),o(2,t.SkipSelf())],ie);var ne='<div class="media-bar-lightbox"\n	hm-panstart="$ctrl.panStart( $event )"\n	hm-pan="$ctrl.pan( $event )"\n	hm-panend="$ctrl.panEnd( $event )"\n	hm-recognizer-options=\'{ invokeApply: false }\'\n	>\n\n	<a class="media-bar-lightbox-prev" ng-click="$ctrl.goPrev()" ng-if="$ctrl.mediaBar.activeIndex > 0">\n		<span class="jolticon jolticon-chevron-left"></span>\n	</a>\n\n	<a class="media-bar-lightbox-next" ng-click="$ctrl.goNext()" ng-if="$ctrl.mediaBar.activeIndex < $ctrl.mediaBar.mediaItems.length - 1">\n		<span class="jolticon jolticon-chevron-right"></span>\n	</a>\n\n	<div class="media-bar-lightbox-controls">\n		<a class="btn btn-outline btn-overlay-variant" ng-href="{{ $ctrl.mediaBar.activeItem.media_item.img_url }}"\n			ng-if="$ctrl.mediaBar.activeItem.media_type == \'image\'"\n			target="_blank"\n			>\n			<span class="jolticon jolticon-download"></span>\n			<span translate>Download</span>\n		</a>\n		<a class="btn btn-danger-outline btn-overlay-variant" ng-click="$ctrl.close()">\n			<span class="jolticon jolticon-remove"></span>\n			<span translate>Close</span>\n		</a>\n	</div>\n\n	<div class="media-bar-lightbox-slider">\n\n		<gj-media-bar-lightbox-item\n			ng-repeat="item in $ctrl.mediaBar.mediaItems track by item.id"\n			item="::item"\n			item-index="::$index"\n			active-index="$ctrl.mediaBar.activeIndex"\n			media-bar="$ctrl.mediaBar"\n			>\n		</gj-media-bar-lightbox-item>\n\n	</div>\n\n</div>\n',oe={opacityStart:.5,scaleStart:.5,controlsHeight:80,itemPadding:40},ae=function(){function e(e,t,i,n,o,a,r,s,l,d){var c=this;this.$timeout=e,this.$animate=t,this.$document=i,this.$element=n,this.$window=o,this.$scope=a,this.$location=r,this.screen=s,this.hotkeys=l,this.mediaBar=d,this.currentSliderOffset=0,this.isDragging=!1,this.waitingForFrame=!1,this.elem=n[0],this.screen.setResizeSpy(a,function(){c.calcMaxDimensions(),c.refreshSliderPosition(),c.$timeout(function(){return a.$broadcast("MediaBarLightbox.onResize")},1)}),this.hotkeys.bindTo(a).add({combo:"right",description:"Next item.",callback:function(e){c.goNext(),e.preventDefault()}}).add({combo:"left",description:"Previous item.",callback:function(e){c.goPrev(),e.preventDefault()}}).add({combo:"esc",description:"Close media lightbox.",callback:function(e){c.close(),e.preventDefault()}})}return e.prototype.ngAfterViewInit=function(){this.sliderElem=this.elem.getElementsByClassName("media-bar-lightbox-slider")[0],this.$document[0].body.appendChild(this.elem),this.calcMaxDimensions(),this.refreshSliderPosition(),this.syncUrl()},e.prototype.calcMaxDimensions=function(){this.maxItemWidth=.8*this.screen.windowWidth,this.maxItemHeight=this.screen.windowHeight-2*oe.controlsHeight},e.prototype.goNext=function(){this.mediaBar.goNext(),this.refreshSliderPosition(),this.syncUrl()},e.prototype.goPrev=function(){this.mediaBar.goPrev(),this.refreshSliderPosition(),this.syncUrl()},e.prototype.close=function(){this.mediaBar.clearActiveItem(),this.syncUrl()},e.prototype.syncUrl=function(){var e="";this.mediaBar.activeItem?("image"==this.mediaBar.activeItem.media_type?e="screenshot-":"video"==this.mediaBar.activeItem.media_type&&(e="video-"),e+=this.mediaBar.activeItem.id):e="close",this.$location.hash(e).replace()},e.prototype.refreshSliderPosition=function(){var e,t=.1*this.screen.windowWidth;e=0==this.mediaBar.activeIndex?t:-(this.maxItemWidth*this.mediaBar.activeIndex-t),this.sliderElem.style.transform="translate3d( "+e+"px, 0, 0 )",this.currentSliderOffset=e},e.prototype.panStart=function(){this.isDragging=!0,this.activeElem=this.elem.getElementsByClassName("active")[0],this.nextElem=this.elem.getElementsByClassName("next")[0],this.prevElem=this.elem.getElementsByClassName("prev")[0],this.elem.classList.add("dragging")},e.prototype.pan=function(e){var t=this;this.waitingForFrame||(this.waitingForFrame=!0,this.$window.requestAnimationFrame(function(){return t.panTick(e)}))},e.prototype.panTick=function(e){this.waitingForFrame=!1,this.isDragging&&(this.sliderElem.style.transform="translate3d( "+(this.currentSliderOffset+e.deltaX)+"px, 0, 0 )")},e.prototype.panEnd=function(e){var t=this;this.isDragging=!1,this.$scope.$apply(function(){t.elem.classList.remove("dragging"),t.activeElem.style.opacity="",t.prevElem&&(t.prevElem.style.opacity=""),t.nextElem&&(t.nextElem.style.opacity=""),t.activeElem.style.transform="",t.prevElem&&(t.prevElem.style.transform=""),t.nextElem&&(t.nextElem.style.transform="");var i=e.velocityX;return Math.abs(i)>.65&&e.distance>10?void(i>0?t.goNext():t.goPrev()):void t.refreshSliderPosition()})},e.prototype.ngOnDestroy=function(){var e=this;this.$timeout(function(){e.elem.classList.contains("ng-leave")||e.$animate.leave(e.$element)},0,!1)},e}();ae=n([t.Component({selector:"gj-media-bar-lightbox",template:ne}),o(0,t.Inject("$timeout")),o(1,t.Inject("$animate")),o(2,t.Inject("$document")),o(3,t.Inject("$element")),o(4,t.Inject("$window")),o(5,t.Inject("$scope")),o(6,t.Inject("$location")),o(7,t.Inject("Screen")),o(8,t.Inject("hotkeys")),o(9,t.Inject(ee)),o(9,t.SkipSelf())],ae);var re='<div class="media-bar-lightbox-item" ng-if="$ctrl.isActive || $ctrl.isNext || $ctrl.isPrev">\n	<div class="media-bar-lightbox-item-inner" ng-switch="$ctrl.item.media_type">\n\n		<!-- Image -->\n		<div ng-switch-when="image">\n			<div class="media-bar-lightbox-item-embed"\n				ng-if="$ctrl.maxWidth && $ctrl.maxHeight"\n				>\n\n				<!--\n					The min/max will be the actual dimensions for the image thumbnail.\n				-->\n				<img\n					gj-img-responsive="{{ $ctrl.item.img_thumbnail }}"\n					alt="{{ $ctrl.item.caption }}"\n					ng-style="{ width: $ctrl.maxWidth + \'px\', height: $ctrl.maxHeight + \'px\' }"\n					>\n			</div>\n\n			<div class="media-bar-lightbox-item-caption" ng-if="$ctrl.item.caption">\n				<h4>{{ $ctrl.item.caption }}</h4>\n			</div>\n		</div>\n\n		<!-- Video -->\n		<div ng-switch-when="video">\n			<div class="media-bar-lightbox-item-embed"\n				ng-if="$ctrl.maxWidth && $ctrl.maxHeight"\n				>\n				<div ng-if="$ctrl.mediaBar.isPlaying != $ctrl.itemIndex ">\n\n					<!--\n						Since we don\'t have the original width/height for videos, we have to just set max dimensions for the thumbnail.\n					-->\n					<img\n						gj-img-responsive="{{ $ctrl.item.img_thumbnail }}"\n						alt="{{ $ctrl.item.title }}"\n						ng-style="{ \'max-height\': $ctrl.maxHeight + \'px\', \'max-width\': $ctrl.maxWidth + \'px\' }"\n						>\n\n					<span class="play-button-overlay" ng-click="$ctrl.play()">\n						<span class="jolticon jolticon-play"></span>\n					</span>\n				</div>\n\n				<div ng-if="$ctrl.mediaBar.isPlaying == $ctrl.itemIndex">\n					<gj-video-embed\n						class="media-bar-lightbox-item-embed"\n						video-provider="{{ $ctrl.item.type }}"\n						video-id="$ctrl.item.url"\n						max-video-width="$ctrl.maxWidth"\n						max-video-height="$ctrl.maxHeight"\n						autoplay="true"\n						>\n					</gj-video-embed>\n				</div>\n			</div>\n\n			<div class="media-bar-lightbox-item-caption">\n				<h4>{{ $ctrl.item.title }}</h4>\n				<p ng-if="$ctrl.item.description" ng-bind-html="$ctrl.item.description | linky"></p>\n			</div>\n		</div>\n\n	</div>\n</div>\n',se=function(){function e(e,t,i,n){var o=this;this.$timeout=e,this.lightbox=n,this.isActive=!1,this.isNext=!1,this.isPrev=!1,this.elem=i[0],t.$on("MediaBarLightbox.onResize",function(){return o.calcDimensions()})}return e.prototype.ngOnInit=function(){this.calcActive(),this.calcDimensions()},e.prototype.ngOnChanges=function(e){e.activeIndex&&this.calcActive()},e.prototype.play=function(){this.mediaBar.isPlaying=this.itemIndex},e.prototype.calcDimensions=function(){this.maxWidth=this.lightbox.maxItemWidth-oe.itemPadding,this.maxHeight=this.lightbox.maxItemHeight;var e=this.elem.getElementsByClassName("media-bar-lightbox-item-caption")[0];if(e&&(this.maxHeight-=e.offsetHeight),"image"==this.item.media_type){var t=this.item.media_item.getDimensions(this.maxWidth,this.maxHeight);this.maxWidth=t.width,this.maxHeight=t.height}},e.prototype.calcActive=function(){var e=this;this.isActive=this.activeIndex==this.itemIndex,this.isNext=this.activeIndex+1==this.itemIndex,this.isPrev=this.activeIndex-1==this.itemIndex,this.elem.classList.remove("active","next","prev"),this.isActive?this.elem.classList.add("active"):this.isPrev?this.elem.classList.add("prev"):this.isNext&&this.elem.classList.add("next"),(this.isActive||this.isNext||this.isPrev)&&this.$timeout(function(){return e.calcDimensions()},0)},e}();n([t.Input("<")],se.prototype,"item",void 0),n([t.Input("<")],se.prototype,"itemIndex",void 0),n([t.Input("<")],se.prototype,"activeIndex",void 0),n([t.Input("<")],se.prototype,"mediaBar",void 0),se=n([t.Component({selector:"gj-media-bar-lightbox-item",template:re}),o(0,t.Inject("$timeout")),o(1,t.Inject("$scope")),o(2,t.Inject("$element")),o(3,t.Inject(ae)),o(3,t.SkipSelf())],se);var le,de,ce,ue,pe=(le=(de=(ce=(ue=angular.module("gj.MediaBar",[])).directive.apply(ue,t.provide(ee))).directive.apply(ce,t.provide(ie))).directive.apply(de,t.provide(ae))).directive.apply(le,t.provide(se)).name,he='<div class="game-play-modal-backdrop anim-fade-in"></div>\n\n<div class="game-play-modal">\n	<div class="game-play-modal-header-controls">\n		<button class="btn btn-outline" ng-click="$ctrl.minimize()" ng-if="$ctrl.canMinimize">\n			<span class="jolticon jolticon-minimize"></span>\n			<span translate>Minimize</span>\n		</button>\n		<button class="btn btn-danger-outline warning" ng-click="$ctrl.close()">\n			<span class="jolticon jolticon-remove"></span>\n			<span translate>Close Game</span>\n		</button>\n	</div>\n\n	<div class="game-play-modal-body">\n\n		<gj-ad-video\n			ng-if="!$ctrl.adShown"\n			ad-resource="Game"\n			ad-resource-id="$ctrl.build.game_id"\n			event-tracking-label="Pre-Roll - Browser"\n			on-ad-shown="$ctrl.onAdShown()"\n			>\n		</gj-ad-video>\n\n		<div gj-game-play-modal-embed\n			ng-if="$ctrl.adShown"\n			build="$ctrl.build"\n			>\n		</div>\n\n	</div>\n</div>\n',me=function(){
function e(e){this.adShown=!1,this.adShown=!this.game._should_show_ads,e.user&&this.game.developer.id==e.user.id&&(this.adShown=!0)}return e.prototype.onAdShown=function(){this.adShown=!0},e}();n([t.Input("<")],me.prototype,"game",void 0),n([t.Input("<")],me.prototype,"build",void 0),n([t.Input("<")],me.prototype,"canMinimize",void 0),n([t.Output()],me.prototype,"minimize",void 0),n([t.Output()],me.prototype,"maximize",void 0),n([t.Output()],me.prototype,"close",void 0),me=n([t.Component({selector:"gj-game-play-modal",template:he}),o(0,t.Inject("App"))],me);var ge='<iframe id="online-game-frame"\n	nwdisable nwfaketop\n	ng-if="$ctrl.src"\n	type="text/html"\n	frameborder="0"\n	scrolling="no"\n	webkitallowfullscreen mozallowfullscreen allowfullscreen\n	width="{{ $ctrl.embedWidth }}"\n	height="{{ $ctrl.embedHeight }}"\n	ng-src="{{ $ctrl.src }}"\n	gj-load="$ctrl.focus()"\n	>\n</iframe>\n',fe=function(){function e(e,t,i,n,o,a,r,s){this.$element=e,this.$sce=t,this.$q=i,this.$interval=n,this.environment=o,this.api=r,this.app=s;var l=e[0];l.classList.add("game-play-modal-embed"),this.build.type==a.TYPE_ROM?this.build.emulator_type==a.EMULATOR_GB||this.build.emulator_type==a.EMULATOR_GBC?(this.embedWidth=640,this.embedHeight=576):this.build.emulator_type==a.EMULATOR_GBA?(this.embedWidth=720,this.embedHeight=480):this.build.emulator_type==a.EMULATOR_NES?(this.embedWidth=512,this.embedHeight=480):this.build.emulator_type==a.EMULATOR_VBOY?(this.embedWidth=768,this.embedHeight=224):this.build.emulator_type==a.EMULATOR_GENESIS?(this.embedWidth=640,this.embedHeight=448):this.build.emulator_type==a.EMULATOR_SNES?(this.embedWidth=512,this.embedHeight=448):this.build.emulator_type==a.EMULATOR_ATARI2600?(this.embedWidth=528,this.embedHeight=669):this.build.emulator_type==a.EMULATOR_C64?(this.embedWidth=836,this.embedHeight=470):this.build.emulator_type==a.EMULATOR_ZX?(this.embedWidth=704,this.embedHeight=592):this.build.emulator_type==a.EMULATOR_CPC?(this.embedWidth=768,this.embedHeight=544):this.build.emulator_type==a.EMULATOR_MSX&&(this.embedWidth=544,this.embedHeight=466):(this.embedWidth=this.build.embed_width,this.embedHeight=this.build.embed_height),l.style.width=this.embedWidth+"px",l.style.height=this.embedHeight+"px"}return e.prototype.ngAfterViewInit=function(){var e=this;this.$q.when().then(function(){return e.app.user?e.api.sendRequest("/web/dash/token"):void 0}).then(function(t){var i=e.environment.gameserverUrl+"/view/"+e.build.id,n=[];t&&t.token&&(n.push("username="+e.app.user.username),n.push("token="+t.token)),i+="?"+n.join("&"),e.src=e.$sce.trustAsResourceUrl(i)}).then(function(){e.$interval(function(){e.focus()},2e3)})},e.prototype.focus=function(){var e=this.$element[0].querySelector("#online-game-frame");e&&e.focus()},e}();n([t.Input("<")],fe.prototype,"build",void 0),fe=n([t.Component({selector:"gj-game-play-modal-embed",template:ge}),o(0,t.Inject("$element")),o(1,t.Inject("$sce")),o(2,t.Inject("$q")),o(3,t.Inject("$interval")),o(4,t.Inject("Environment")),o(5,t.Inject("Game_Build")),o(6,t.Inject("Api")),o(7,t.Inject("App"))],fe);var ve=function(){function e(e,t,i,n,o,a,r,s,l,d,c,u,p){this.$rootScope=e,this.$document=t,this.$q=i,this.$state=n,this.$compile=o,this.$animate=a,this.$injector=r,this.Growls=s,this.HistoryTick=l,this.Environment=d,this.Popover=c,this.Analytics=u,this.Game_Build=p,this.hasModal=!1}return e.prototype.show=function(e,t){function i(){s.classList.remove("game-play-modal-open"),d[0].style.display="none";var e=c.get("Minbar"),t=e.add({title:this.game.title,thumb:this.game.img_thumbnail,isActive:!0,onClick:function(){e.remove(t),n()}})}function n(){s.classList.add("game-play-modal-open"),d[0].style.display="block"}function o(){u.leave(d).then(function(){r.$destroy(),s.classList.remove("game-play-modal-open"),p.hasModal=!1}),c.has("Game_RatingGrowl")&&c.get("Game_RatingGrowl").show(e)}if(this.Analytics.trackEvent("game-play","play"),this.Environment.isClient&&t.type!=this.Game_Build.TYPE_HTML&&t.type!=this.Game_Build.TYPE_ROM){var a=require("nw.gui");return a.Shell.openExternal(this.Environment.baseUrl+this.$state.href("discover.games.view.overview",{slug:e.slug,id:e.id})),this.Popover.hideAll(),this.$q.resolve()}if(this.hasModal)return this.Growls.error("You already have a browser game open. You can only have one running at a time.","Oh no!"),this.$q.reject();this.hasModal=!0,this.HistoryTick.sendBeacon("game-build",t.id,{sourceResource:"Game",sourceResourceId:e.id});var r=this.$rootScope.$new(!0);r.game=e,r.build=t,r.canMinimize=this.$injector.has("Minbar"),r.minimize=i,r.maximize=n,r.close=o;var s=this.$document.find("body").eq(0)[0],l=angular.element('\n			<gj-game-play-modal\n				game="game"\n				build="build"\n				can-minimize="canMinimize"\n				minimize="minimize()"\n				maximize="maximize()"\n				close="close()"\n				>\n			</gj-game-play-modal>'),d=this.$compile(l)(r);this.$animate.enter(d,angular.element(s)),s.classList.add("game-play-modal-open");var c=this.$injector,u=this.$animate,p=this},e}();ve=n([t.Injectable(),o(0,t.Inject("$rootScope")),o(1,t.Inject("$document")),o(2,t.Inject("$q")),o(3,t.Inject("$state")),o(4,t.Inject("$compile")),o(5,t.Inject("$animate")),o(6,t.Inject("$injector")),o(7,t.Inject("Growls")),o(8,t.Inject("HistoryTick")),o(9,t.Inject("Environment")),o(10,t.Inject("Popover")),o(11,t.Inject("Analytics")),o(12,t.Inject("Game_Build"))],ve);var ye,be,we,_e=(ye=(be=(we=angular.module("gj.Game.PlayModal",["gj.Growls","gj.Ad.Video","gj.HistoryTick","gj.Analytics","gj.Load"])).directive.apply(we,t.provide(me))).directive.apply(be,t.provide(fe))).service.apply(ye,t.provide("Game_PlayModal",{useClass:ve})).name,je=function(){function e(e,t,i,n,o,a){this.$document=e,this.$q=t,this.environment=i,this.referrer=n,this.partnerReferral=o,this.device=a,this._sources={}}return e.prototype.trackSource=function(e,t){angular.isUndefined(this._sources[e+":"+t])&&(this._sources[e+":"+t]=this.referrer.get())},e.prototype.getSource=function(e,t){return this._sources[e+":"+t]},e.prototype.sendBeacon=function(e,t,i){var n=this;return void 0===i&&(i={}),this.environment.isPrerender?void 0:this.$q(function(o){var a=[];a.push("cb="+Date.now()),a.push("os="+n.device.os());var r=n.device.arch();if(r&&a.push("arch="+r),i.sourceResource&&i.sourceResourceId){var s=n.getSource(i.sourceResource,i.sourceResourceId);s&&a.push("source="+s);var l=n.partnerReferral.getReferrer(i.sourceResource,i.sourceResourceId);l&&a.push("ref="+l)}i.key&&a.push("key="+i.key);var d=n.$document[0].createElement("img");d.width=1,d.height=1,d.src=n.environment.apiHost+"/tick/"+e+"/"+t+"?"+a.join("&"),d.onload=d.onerror=function(){delete d.onload,delete d.onerror,o()},"development"==n.environment.env&&console.log("Tracking history tick.",{type:e,resourceId:t,queryString:a.join("&")})})},e}();je=n([t.Injectable(),o(0,t.Inject("$document")),o(1,t.Inject("$q")),o(2,t.Inject("Environment")),o(3,t.Inject("Referrer")),o(4,t.Inject("PartnerReferral")),o(5,t.Inject("Device"))],je);var $e,Se=($e=angular.module("gj.HistoryTick",["gj.Referrer"])).service.apply($e,t.provide("HistoryTick",{useClass:je})).name,Ee=function(){function e(){}return e.prototype.loaded=function(e){this.onLoad({$event:e})},e}();n([t.Output("gjLoad")],Ee.prototype,"onLoad",void 0),n([t.HostListener("load",["$event"])],Ee.prototype,"loaded",null),Ee=n([t.Directive({selector:"[gj-load]"})],Ee);var Ie,ke=(Ie=angular.module("gj.Load",[])).directive.apply(Ie,t.provide(Ee)).name,xe=function(){function e(e){this.$interpolate=e}return e.prototype.getString=function(e,t){return t?this.$interpolate(e)(t):e},e}();xe=n([t.Injectable(),o(0,t.Inject("$interpolate"))],xe);var Te,Pe=(Te=angular.module("gj.Translate.Spoof",[])).service.apply(Te,t.provide("gettextCatalog",{useClass:xe})).name,Ce=function(){function e(e,t){this.$window=e,this.$location=t}return e.prototype.trackReferrer=function(e,t){var i=this.$location.search(),n=i.ref;n&&this.$window.sessionStorage.setItem("partner-ref:"+e+":"+t,n)},e.prototype.getReferrer=function(e,t){return this.$window.sessionStorage.getItem("partner-ref:"+e+":"+t)},e}();Ce=n([t.Injectable(),o(0,t.Inject("$window")),o(1,t.Inject("$location"))],Ce);var Ae,Me=(Ae=angular.module("gj.PartnerReferral",[])).service.apply(Ae,t.provide("PartnerReferral",{useClass:Ce})).name,Oe=function(){function e(e,t){this.$element=e,this.popoverService=t,this.popoverTriggerEvent="click",this.popoverTriggerDisabled=!1}return e.prototype.getPopover=function(){return this.popoverService.getPopover(this.popoverId)},e.prototype.onClick=function(e){if("click"!==this.popoverTriggerEvent||this.popoverTriggerDisabled)return!0;var t=this.getPopover();return t?(this.popoverService.hideAll({skip:t}),t.trigger(this.$element),e.stopPropagation(),void 0):!0},e.prototype.onMouseEnter=function(){if("hover"!==this.popoverTriggerEvent||this.popoverTriggerDisabled)return!0;var e=this.getPopover();e&&(e.attachedTrigger=this,e.show(this.$element))},e.prototype.onMouseLeave=function(){if("hover"!==this.popoverTriggerEvent||this.popoverTriggerDisabled)return!0;var e=this.getPopover();e&&(e.attachedTrigger=this,e.hide())},e}();n([t.Input("@gjPopoverTrigger")],Oe.prototype,"popoverId",void 0),n([t.Input("@?")],Oe.prototype,"popoverTriggerEvent",void 0),n([t.Input("<")],Oe.prototype,"popoverTriggerDisabled",void 0),n([t.HostListener("click",["$event"])],Oe.prototype,"onClick",null),n([t.HostListener("mouseenter")],Oe.prototype,"onMouseEnter",null),n([t.HostListener("mouseleave")],Oe.prototype,"onMouseLeave",null),Oe=n([t.Directive({selector:"gj-popover-trigger"}),o(0,t.Inject("$element")),o(1,t.Inject("Popover"))],Oe);var Re=function(){function e(){}return e}();n([t.Output()],Re.prototype,"hide",void 0),Re=n([t.Component({selector:"gj-popover-backdrop",template:'\n		<div class="popover-backdrop" ng-click="$ctrl.hide()"></div>\n	'})],Re);var Be=function(){function e(e){this.$element=e}return e}();Be=n([t.Directive({selector:"[gj-popover-context]"}),o(0,t.Inject("$element"))],Be);var Le='<div class="arrow"></div>\n\n<div class="popover-content"\n	ng-style="{ \'max-height\': $ctrl.appendToBody ? ($ctrl.screen.windowHeight - 100) + \'px\' : undefined }"\n	ng-transclude>\n</div>\n',De=function(){function e(e,t,i,n,o,a,r,s,l,d,c,u,p,h){this.$element=e,this.$scope=t,this.$q=i,this.$animate=n,this.$position=o,this.$window=a,this.$document=r,this.$rootScope=s,this.$compile=l,this.popoverService=d,this.scroll=c,this.ruler=u,this.screen=p,this.context=h,this.appendToBody=!1,this.triggerManually=!1,this.position="bottom",this.hideOnStateChange=!1,this.isShowing=!1,this.isAppendedToBody=!1,this.originalParent=this.$element.parent()}return e.prototype.onMouseEnter=function(){this.attachedTrigger&&"hover"===this.attachedTrigger.popoverTriggerEvent&&this.show(this.attachedTrigger.$element)},e.prototype.onMouseLeave=function(){this.attachedTrigger&&"hover"===this.attachedTrigger.popoverTriggerEvent&&this.hide()},e.prototype.onClick=function(e){return e.gjPopoverClick=!0,!0},e.prototype.ngOnInit=function(){this.$element.addClass("popover"),this.popoverService.registerPopover(this.id,this)},e.prototype.ngOnDestroy=function(){this.popoverService.getPopover(this.id)===this&&this.popoverService.deregisterPopover(this.id),this.hide(!0)},e.prototype.hidePopovers=function(e){var t=this;e&&e.gjPopoverClick||this.$rootScope.$apply(function(){return t.popoverService.hideAll()})},e.prototype.trigger=function(e){this.isShowing?this.hide():this.show(e)},e.prototype.show=function(e){var t=this;if(!this.isShowing){var i;return this.focused&&(i=this.focused({})),this.$element.removeClass("left top right bottom").addClass(this.position),this.appendToBody&&!this.isAppendedToBody?(this.$document.find("body").append(this.$element),this.isAppendedToBody=!0):!this.appendToBody&&this.isAppendedToBody&&(this.originalParent.append(this.$element),this.isAppendedToBody=!1),this.$q.when(i).then(function(){var i,n=t.$element[0],o=e[0].offsetWidth,a=e[0].offsetHeight,r=t.$position.offset(e);t.trackElementWidth&&!t.screen.isWindowXs&&(i=t.$document[0].querySelector(t.trackElementWidth),i&&(n.style.width=i.offsetWidth+"px",n.style.maxWidth="none")),i||(n.style.maxWidth="",n.style.width="");var s,l,d,c,u=t.ruler.outerWidth(n),p=t.ruler.outerHeight(n),h=t.positionBy||(t.appendToBody?"offset":"position");if("offset"===h)s=r.left,l=r.top;else if("fixed"===h)s=r.left-t.scroll.context.duScrollLeft(),l=r.top-t.scroll.context.duScrollTop();else{var m=t.$position.position(e);s=m.left,l=m.top}d=s+o,c=l+a,n.style.position="fixed"===h?"fixed":"absolute","top"===t.position||"bottom"===t.position?(n.style.left="left"===t.positionHorizontal||r.left>t.screen.windowWidth/2?d-u+"px":s+"px","bottom"===t.position?n.style.top=c+"px":"top"===t.position&&(n.style.bottom=l+"px")):("left"===t.position||"right"===t.position)&&(n.style.top=l>t.screen.windowHeight/2?c-p+"px":l+"px","left"===t.position?n.style.right=s+"px":"right"===t.position&&(n.style.left=d+"px"));var g=t.$window.getComputedStyle(n),f=n.getElementsByClassName("arrow")[0];if(f)if("top"===t.position||"bottom"===t.position){var v=g.left?(u-t.ruler.width(n))/2+parseFloat(g.left):0;f.style.left=s+Math.min(o/2,u/2)-v+"px"}else if("left"===t.position||"right"===t.position){var v=g.top?(p-t.ruler.height(n))/2+parseFloat(g.top):0;f.style.top=l+Math.min(a/2,p/2)-v+"px"}t.$animate.addClass(t.$element,"active"),t.isShowing=!0,t.hidePopoversWrapped=function(e){return t.hidePopovers(e)},t.$document.on("click",t.hidePopoversWrapped);var y=angular.element('<gj-popover-backdrop hide="$ctrl.hide()"></gj-popover-backdrop>');t.backdropElemCompiled=t.$compile(y)(t.$scope),t.context?t.context.$element.append(t.backdropElemCompiled):t.$document.find("body").append(t.backdropElemCompiled),t.hideOnStateChange&&!t.hideDeregister&&(t.hideDeregister=t.$scope.$on("$stateChangeStart",function(){t.popoverService.hideAll()}))})}},e.prototype.hide=function(e){var t=this;return void 0===e&&(e=!1),this.isShowing?(this.isShowing=!1,this.hidePopoversWrapped&&this.$document.off("click",this.hidePopoversWrapped),this.backdropElemCompiled&&this.backdropElemCompiled.remove(),this.hideOnStateChange&&this.hideDeregister&&(this.hideDeregister(),this.hideDeregister=void 0),this.$animate.removeClass(this.$element,"active").then(function(){return t.blurred?t.blurred({}):void 0}).then(function(){e&&t.$element.remove()})):void 0},e}();n([t.Input("@popoverId")],De.prototype,"id",void 0),n([t.Input("<?popoverAppendToBody")],De.prototype,"appendToBody",void 0),n([t.Input("<?popoverTriggerManually")],De.prototype,"triggerManually",void 0),n([t.Input("@?popoverPositionBy")],De.prototype,"positionBy",void 0),n([t.Input("@?popoverTrackElementWidth")],De.prototype,"trackElementWidth",void 0),n([t.Input("@?popoverPosition")],De.prototype,"position",void 0),n([t.Input("@?popoverPositionHorizontal")],De.prototype,"positionHorizontal",void 0),n([t.Input("<?popoverHideOnStateChange")],De.prototype,"hideOnStateChange",void 0),n([t.Output("?popoverOnFocus")],De.prototype,"focused",void 0),n([t.Output("?popoverOnBlur")],De.prototype,"blurred",void 0),n([t.HostListener("mouseenter")],De.prototype,"onMouseEnter",null),n([t.HostListener("mouseleave")],De.prototype,"onMouseLeave",null),n([t.HostListener("click",["$event"])],De.prototype,"onClick",null),De=n([t.Component({selector:"gj-popover",template:Le,legacy:{transclude:!0}}),o(0,t.Inject("$element")),o(1,t.Inject("$scope")),o(2,t.Inject("$q")),o(3,t.Inject("$animate")),o(4,t.Inject("$position")),o(5,t.Inject("$window")),o(6,t.Inject("$document")),o(7,t.Inject("$rootScope")),o(8,t.Inject("$compile")),o(9,t.Inject("Popover")),o(10,t.Inject("Scroll")),o(11,t.Inject("Ruler")),o(12,t.Inject("Screen")),o(13,t.Inject(Be)),o(13,t.SkipSelf()),o(13,t.Optional())],De);var Ue=function(){function e(){this.popovers={}}return e.prototype.registerPopover=function(e,t){this.popovers[e]=t},e.prototype.deregisterPopover=function(e){delete this.popovers[e]},e.prototype.getPopover=function(e){return this.popovers[e]||void 0},e.prototype.hideAll=function(e){void 0===e&&(e={}),angular.forEach(this.popovers,function(t){e.skip&&e.skip.id===t.id||t.triggerManually||t.isShowing&&t.hide()})},e}();Ue=n([t.Injectable()],Ue);var Ge,We,Fe,He,Ne,qe=(Ge=(We=(Fe=(He=(Ne=angular.module("gj.Popover",[])).directive.apply(Ne,t.provide(Oe))).directive.apply(He,t.provide(Re))).directive.apply(Fe,t.provide(De))).directive.apply(We,t.provide(Be))).service.apply(Ge,t.provide("Popover",{useClass:Ue})).name,Ve=function(){function e(e,t){this.$element=e,this.$window=t}return e.prototype.ngOnInit=function(){var e=this;this.$window.addEventListener("message",function(t){switch(console.log("got msg",t.data),t.data.type){case"theme-update":if(!t.data.theme||!t.data.definition)return;return void e.refreshStyles(t.data.definition,t.data.theme)}},!1)},e.prototype.ngAfterViewInit=function(){this.styleElem=this.$element[0].getElementsByTagName("style")[0],this.refreshStyles(this.definition,this.theme)},e.prototype.refreshStyles=function(e,t){var i=[],n=[];angular.forEach(e.definitions,function(e,o){if(t&&"undefined"!=typeof t[o]&&t[o]){var a;"image"==e.type?a='url("'+t[o].img_url+'")':"background-repeat"==e.type?a="repeat-x"==t[o]?"repeat-x":"repeat-y"==t[o]?"repeat-y":"no-repeat"==t[o]?"no-repeat":"repeat":"background-position"==e.type?a="topLeft"==t[o]?"top left":"topRight"==t[o]?"top right":"right"==t[o]?"center right":"bottomRight"==t[o]?"bottom right":"bottom"==t[o]?"bottom center":"bottomLeft"==t[o]?"bottom left":"left"==t[o]?"center left":"middle"==t[o]?"center center":"top center":"fontFamily"==e.type?(a="'"+t[o].family+"'",n.push("@import url(//fonts.googleapis.com/css?family="+t[o].family.replace(/ /g,"+")+");")):a=t[o],_.forEach(e.injections||[e],function(e){if(!angular.isUndefined(e.property)){var t=e.selector+"{"+e.property+":"+a+"}";i.push(t)}})}});var o=i.join("");o=n.join("")+o,this.styleElem.innerHTML=o},e}();n([t.Input("<")],Ve.prototype,"definition",void 0),n([t.Input("<")],Ve.prototype,"theme",void 0),Ve=n([t.Component({selector:"gj-theme-injector",template:"<style></style>"}),o(0,t.Inject("$element")),o(1,t.Inject("$window"))],Ve);var ze,Ye=(ze=angular.module("gj.Theme.Injector",[])).directive.apply(ze,t.provide(Ve)).name,Xe='<div class="card fill-darkest"\n	ng-class="{ \'card-expandable\': $ctrl.isExpandable, \'card-draggable\': $ctrl.isDraggable, \'card-inactive\': $ctrl.isInactive, \'card-disabled\': $ctrl.isDisabled }"\n	>\n\n	<div class="card-drag-handle" ng-if="$ctrl.isDraggable" ui-tree-handle>\n		<span class="jolticon jolticon-arrows-v"></span>\n	</div>\n\n	<div class="card-chevron" ng-if="$ctrl.isExpandable">\n		<span class="jolticon" ng-class="\'jolticon-chevron-\' + ($ctrl.isExpanded ? \'down\' : \'right\')"></span>\n	</div>\n\n	<div ng-transclude></div>\n</div>\n',Ke=function(){function e(){this.isDraggable=!1,this.isExpandable=!1,this.isExpanded=!1,this.isInactive=!1,this.isDisabled=!1}return e}();n([t.Input("<?")],Ke.prototype,"isDraggable",void 0),n([t.Input("<?")],Ke.prototype,"isExpandable",void 0),n([t.Input("<?")],Ke.prototype,"isExpanded",void 0),n([t.Input("<?")],Ke.prototype,"isInactive",void 0),n([t.Input("<?")],Ke.prototype,"isDisabled",void 0),Ke=n([t.Component({selector:"gj-card",template:Xe,legacy:{transclude:!0}})],Ke);var Je,Ze=(Je=angular.module("gj.Card",[])).directive.apply(Je,t.provide(Ke)).name,Qe=function(){function e(e){this.$element=e}return e.prototype.ngOnInit=function(){var e=this;this.updateTimer(),this.intervalHandle=window.setInterval(function(){return e.updateTimer()},1e3)},e.prototype.updateTimer=function(){var e=(this.end-Date.now())/1e3;if(0>e)return void(this.$element[0].innerText="0:0:0");var t=0;Math.floor(e/86400)>3&&(t=Math.floor(e/86400),t&&(e-=86400*t));var i=Math.floor(e/3600);i&&(e-=3600*i);var n=Math.floor(e/60);n&&(e-=60*n);var o=Math.floor(e),a=this.pad(i)+":"+this.pad(n)+":"+this.pad(o);t&&(a=t+":"+a),this.$element[0].innerText=a},e.prototype.pad=function(e){return 10>e?"0"+e:""+e},e.prototype.ngOnDestroy=function(){this.intervalHandle&&window.clearInterval(this.intervalHandle)},e}();n([t.Input("<")],Qe.prototype,"end",void 0),Qe=n([t.Component({selector:"gj-countdown",template:""}),o(0,t.Inject("$element"))],Qe);var et,tt=(et=angular.module("gj.Countdown",[])).directive.apply(et,t.provide(Qe)).name,it=nt=function(e){function t(t){var i=e.call(this,t)||this;return t&&t.theme&&(i.theme=new nt.SiteTheme(t.theme)),t&&t.content_blocks&&(i.content_blocks=nt.SiteContentBlock.populate(t.content_blocks)),i}return i(t,e),t}(f);it.STATUS_INACTIVE="inactive",it.STATUS_ACTIVE="active",it.STATUS_REMOVED="removed",it=nt=n([t.Injectable()],it);var nt,ot=angular.module("gj.Site",["gj.Model"]).factory("Site",r).name,at=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(f);at=n([t.Injectable()],at);var rt=angular.module("gj.Site.ContentBlock",["gj.Model"]).factory("SiteContentBlock",s).name,st=function(e){function t(t){var i=e.call(this,t)||this;return t&&t.data&&(i.data=JSON.parse(t.data)||{}),i}return i(t,e),t}(f);st=n([t.Injectable()],st);var lt=angular.module("gj.Site.Template",["gj.Model"]).factory("SiteTemplate",l).name,dt=ct=function(e){function t(t){var i=e.call(this,t)||this;return t&&t.template&&(i.template=new ct.SiteTemplate(t.template)),t&&t.data&&(i.data=JSON.parse(t.data)||{}),i}return i(t,e),t}(f);dt=ct=n([t.Injectable()],dt);var ct,ut=angular.module("gj.Site.Theme",["gj.Model"]).factory("SiteTheme",d).name,pt={widget:/\{\%\s(.+?)\s\%\}/,whitespace:/\s+/g,whitespaceTrim:/^\s+|\s+$/g},ht=function(){function e(e,t,i){this.widgets={},this.contentClass="widget-compiler-compiled-content",this.addWidget(e),this.addWidget(t),this.addWidget(i)}return e.prototype.addWidget=function(e){this.widgets[e.name]=e},e.prototype.setContentClass=function(e){this.contentClass=e},e.prototype.compile=function(e,t){if(!t)return void 0;e.__widgetCompilerChildScopes&&e.__widgetCompilerChildScopes.length&&e.__widgetCompilerChildScopes.forEach(function(e){e.$destroy()}),e.__widgetCompilerChildScopes=[];for(var i='<div class="'+this.contentClass+'">',n=t,o={},a=null;a=n.match(pt.widget);)if(a){var r=a[0],s=a[1];i+=n.substring(0,a.index);var l=this.processWidgetMatch(e,s);if(l){var d=Math.random().toString(36).substr(2);i+='</div><div id="_inj_'+d+'_"></div><div class="'+this.contentClass+'">',o["_inj_"+d+"_"]=l.element,e.__widgetCompilerChildScopes.push(l.scope)}n=n.substring(a.index+r.length)}i+=n+"</div>";var c=angular.element("<div>"+i+"</div>");return angular.forEach(o,function(e,t){angular.element(c[0].querySelector("#"+t)).replaceWith(e[0])}),c},e.prototype.processWidgetMatch=function(e,t){t=t.replace(pt.whitespaceTrim,""),t=t.replace(pt.whitespace," ");var i=t.split(" ");if(!i||!i.length)return void 0;var n=i[0];if(!this.widgets[n])return void 0;i.shift();var o=e.$new(!0),a=this.widgets[n].compile(o,i);return a?{element:a,scope:o}:void o.$destroy()},e}();ht=n([t.Injectable(),o(0,t.Inject("WidgetCompilerWidgetYoutube")),o(1,t.Inject("WidgetCompilerWidgetVimeo")),o(2,t.Inject("WidgetCompilerWidgetSoundcloud"))],ht);var mt=function(){function e(e,t,i){this.$scope=e,this.$element=t,this.compiler=i,this.content="",this.isDisabled=!1}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){this.update()},e.prototype.update=function(){if(!this.content)return void this.$element.empty();if(this.isDisabled)this.$element.html(this.content);else{var e=this.compiler.compile(this.contextScope||this.$scope,this.content);e&&this.$element.empty().append(e)}},e}();n([t.Input("<gjWidgetCompilerBind")],mt.prototype,"content",void 0),n([t.Input("<?widgetCompilerDisabled")],mt.prototype,"isDisabled",void 0),n([t.Input("<?widgetCompilerScope")],mt.prototype,"contextScope",void 0),mt=n([t.Directive({selector:"gj-widget-compiler-bind"}),o(0,t.Inject("$scope")),o(1,t.Inject("$element")),o(2,t.Inject("WidgetCompiler"))],mt);var gt='\n	<gj-widget-compiler-widget-youtube\n		video-id="videoId"\n		>\n	</gj-widget-compiler-widget-youtube>\n',ft=function(){function e(e){this.$compile=e,this.name="youtube"}return e.prototype.compile=function(e,t){if(void 0===t&&(t=[]),!t||!t.length)throw new Error("Invalid params for widget.");return e.videoId=t[0],this.$compile(gt)(e)},e}();ft=n([t.Injectable(),o(0,t.Inject("$compile"))],ft);var vt='\n	<gj-widget-compiler-widget-vimeo\n		video-id="videoId"\n		>\n	</gj-widget-compiler-widget-vimeo>\n',yt=function(){function e(e){this.$compile=e,this.name="vimeo"}return e.prototype.compile=function(e,t){if(void 0===t&&(t=[]),!t||!t.length)throw new Error("Invalid params for widget.");return e.videoId=t[0],this.$compile(vt)(e)},e}();yt=n([t.Injectable(),o(0,t.Inject("$compile"))],yt);var bt='\n	<gj-widget-compiler-widget-soundcloud\n		track-id="trackId"\n		color="color"\n		>\n	</gj-widget-compiler-widget-soundcloud>\n',wt=function(){function e(e){this.$compile=e,this.name="soundcloud"}return e.prototype.compile=function(e,t){if(!t||!t.length)throw new Error("Invalid params for widget.");return e.trackId=t[0],t[1]&&(e.color=t[1].replace(/[^0-9A-Za-z]/g,"")),this.$compile(bt)(e)},e}();wt=n([t.Injectable(),o(0,t.Inject("$compile"))],wt);var _t=function(){function e(){this.videoId=""}return e}();n([t.Input("<videoId")],_t.prototype,"videoId",void 0),_t=n([t.Component({selector:"gj-widget-compiler-widget-youtube",template:'\n		<gj-video-embed\n			video-provider="youtube"\n			video-id="$ctrl.videoId"\n			>\n		</gj-video-embed>\n	'})],_t);var jt=function(){function e(){this.videoId=""}return e}();n([t.Input("<videoId")],jt.prototype,"videoId",void 0),jt=n([t.Component({selector:"gj-widget-compiler-widget-vimeo",template:'\n		<gj-video-embed\n			video-provider="vimeo"\n			video-id="$ctrl.videoId"\n			>\n		</gj-video-embed>\n	'})],jt);var $t=function(){function e(e){this.$sce=e,this.trackId="",this.color=""}return e.prototype.ngOnInit=function(){this.embedSrc="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/"+this.trackId,this.color&&(this.embedSrc+="&amp;color="+this.color),this.embedSrc=this.$sce.trustAsResourceUrl(this.embedSrc)},e}();n([t.Input("<trackId")],$t.prototype,"trackId",void 0),n([t.Input("<?color")],$t.prototype,"color",void 0),$t=n([t.Component({selector:"gj-widget-compiler-widget-soundcloud",template:'\n		<iframe nwdisable nwfaketop\n			width="100%"\n			height="166"\n			scrolling="no"\n			frameborder="no"\n			ng-src="{{ $ctrl.embedSrc }}"\n			>\n		</iframe>\n	'}),o(0,t.Inject("$sce"))],$t);var St,Et,It,kt,xt,Tt,Pt,Ct,At=(St=(Et=(It=(kt=(xt=(Tt=(Pt=(Ct=angular.module("gj.WidgetCompiler",[])).service.apply(Ct,t.provide("WidgetCompiler",{useClass:ht}))).directive.apply(Pt,t.provide(mt))).service.apply(Tt,t.provide("WidgetCompilerWidgetYoutube",{useClass:ft}))).directive.apply(xt,t.provide(_t))).service.apply(kt,t.provide("WidgetCompilerWidgetVimeo",{useClass:yt}))).directive.apply(It,t.provide(jt))).service.apply(Et,t.provide("WidgetCompilerWidgetSoundcloud",{useClass:wt}))).directive.apply(St,t.provide($t)).name,Mt='\n	<div ng-if="game && packages">\n		<gj-game-package-card\n			ng-repeat="package in packages"\n			game="::game"\n			sellable="::package._sellable"\n			game-package="::package"\n			game-releases="::package._releases"\n			game-builds="::package._builds"\n			>\n		</gj-game-package-card>\n	</div>\n',Ot=function(){function e(e){this.$compile=e,this.name="game-packages"}return e.prototype.compile=function(e,t){return void 0===t&&(t=[]),e.$watchGroup(["$parent.game","$parent.packages"],function(t){var i=t[0],n=t[1];angular.extend(e,{game:i,packages:n})}),this.$compile(Mt)(e)},e}();Ot=n([t.Injectable(),o(0,t.Inject("$compile"))],Ot);var Rt,Bt=(Rt=angular.module("gj.WidgetCompiler.WidgetGamePackages",[])).service.apply(Rt,t.provide("WidgetCompilerWidgetGamePackages",{useClass:Ot})).name,Lt='\n	<div ng-if="mediaItems.length">\n		<gj-media-bar media-items="mediaItems"></gj-media-bar>\n	</div>\n',Dt=function(){function e(e){this.$compile=e,this.name="game-media"}return e.prototype.compile=function(e,t){return void 0===t&&(t=[]),e.$watchGroup(["$parent.mediaItems"],function(t){var i=t[0];angular.extend(e,{mediaItems:i})}),this.$compile(Lt)(e)},e}();Dt=n([t.Injectable(),o(0,t.Inject("$compile"))],Dt);var Ut,Gt=(Ut=angular.module("gj.WidgetCompiler.WidgetGameMedia",[])).service.apply(Ut,t.provide("WidgetCompilerWidgetGameMedia",{useClass:Dt})).name,Wt='\n	<div gj-widget-compiler-bind="game.description"></div>\n',Ft=function(){function e(e){this.$compile=e,this.name="game-description"}return e.prototype.compile=function(e,t){return void 0===t&&(t=[]),e.$watchGroup(["$parent.game"],function(t){var i=t[0];angular.extend(e,{game:i})}),this.$compile(Wt)(e)},e}();Ft=n([t.Injectable(),o(0,t.Inject("$compile"))],Ft);var Ht,Nt=(Ht=angular.module("gj.WidgetCompiler.WidgetGameDescription",[])).service.apply(Ht,t.provide("WidgetCompilerWidgetGameDescription",{useClass:Ft})).name,qt=function(){function e(){this.ver=null}return e}();qt=n([t.Injectable()],qt);var Vt='<link rel="stylesheet" ng-href="{{ $ctrl.templates[ $ctrl.site.theme.template.key ].style }}">\n\n<div ng-if="!$ctrl.isLoading">\n	<gj-theme-injector\n		definition="$ctrl.site.theme.template.data"\n		theme="$ctrl.site.theme.data"\n		>\n	</gj-theme-injector>\n\n	<div ng-include="$ctrl.templates[ $ctrl.site.theme.template.key ].view"></div>\n\n</div>\n',zt=function(){function e(e,t,i,n,o,a,r,s,l,d,c,u,p,h,m){var g=this;this.$window=i,this.$scope=n,this.metaService=o,this.siteModel=c,this.gameModel=u,this.screenshotModel=p,this.videoModel=h,this.packageModel=m,this.isLoading=!0,this.templates={};var f=window.location.host.substr(0,window.location.host.indexOf(".")),v=e.path().substr(1);this.templates={vash:{style:t.trustAsResourceUrl("/app/vash.css"),view:t.trustAsResourceUrl("/app/templates/vash/vash.html")},redux:{style:t.trustAsResourceUrl("/app/redux.css"),view:t.trustAsResourceUrl("/app/templates/redux/redux.html")}},a.sendRequest("/sites-io/"+f+"/"+v).then(function(e){return g.bootstrap(e)}),this.$window.addEventListener("message",function(e){return g.message(e)}),r.setContentClass("content"),r.addWidget(s),r.addWidget(l),r.addWidget(d),this.compilerScope=n.$new(!0)}return e.prototype.bootstrap=function(e){var t=this;this.isLoading=!1,this.metaService.title="yo",this.site=new this.siteModel(e.site),this.contentBlock=this.site.content_blocks[0],this.game=new this.gameModel(e.game),this.mediaItems=[],e.mediaItems&&e.mediaItems.length&&e.mediaItems.forEach(function(e){"image"==e.media_type?t.mediaItems.push(new t.screenshotModel(e)):"video"==e.media_type&&t.mediaItems.push(new t.videoModel(e))});var i=this.packageModel.processPackagePayload(e);angular.extend(this,i),this.packages=this.packages||[],this.compilerScope.game=this.game,this.compilerScope.packages=this.packages,this.compilerScope.mediaItems=this.mediaItems},e.prototype.message=function(e){var t=this;this.$scope.$apply(function(){switch(e.data.type){case"theme-update":if(!e.data.template)return;return void(t.site.theme.template=e.data.template);case"content-update":if(!e.data.block)return;return void t.contentBlock.assign(e.data.block)}})},e}();zt=n([t.Component({selector:"gj-app",template:Vt}),o(0,t.Inject("$location")),o(1,t.Inject("$sce")),o(2,t.Inject("$window")),o(3,t.Inject("$scope")),o(4,t.Inject("Meta")),o(5,t.Inject("Api")),o(6,t.Inject("WidgetCompiler")),o(7,t.Inject("WidgetCompilerWidgetGamePackages")),o(8,t.Inject("WidgetCompilerWidgetGameMedia")),o(9,t.Inject("WidgetCompilerWidgetGameDescription")),o(10,t.Inject("Site")),o(11,t.Inject("Game")),o(12,t.Inject("Game_Screenshot")),o(13,t.Inject("Game_Video")),o(14,t.Inject("Game_Package"))],zt),t.enableProdMode();var Yt=angular.module("App",["ngSanitize","ngAnimate","ui.router","ui.bootstrap.collapse","ui.bootstrap.modal","cfp.hotkeys","hmTouchEvents",g,"gj.Api","gj.Payload",y,k,"gj.Error",A,U,"gj.Analytics","gj.Loading","gj.ExpandWhen","gj.Form","gj.History","gj.Growls","gj.Tooltip","gj.Ruler",F,z,Z,At,Bt,Gt,Nt,"gj.MediaItem","gj.Game.Screenshot","gj.Game.Video",pe,"gj.Game","gj.User","gj.Sellable","gj.Sellable.Pricing","gj.Game.Release","gj.Game.Build","gj.Game.Build.File","gj.Game.Build.Param","gj.Game.Build.LaunchOption","gj.Game.Package","gj.Game.Package.Card","gj.Currency",_e,Se,ke,Me,"gj.Time","gj.Ad","gj.Ad.Video","gj.Game.Downloader",qe,"gj.Device","gj.ExpandWhen","gj.Form","gj.Currency","gj.Filesize",Pe,Ye,Ze,tt,ot,rt,lt,ut]).config(["$locationProvider","$uiViewScrollProvider","EnvironmentProvider","$sceDelegateProvider",function(e,t,i,n){
n.resourceUrlWhitelist(["self","https://sites-io.gjcdn.net/**"]),e.html5Mode(!0).hashPrefix("!"),t.useAnchorScroll()}]).name;(Xt=(Kt=angular.module(Yt)).service.apply(Kt,t.provide("App",{useClass:qt}))).directive.apply(Xt,t.provide(zt)),setTimeout(function(){e.bootstrap(Yt)},0);var Xt,Kt}(vendor.ngMetadata_platform,vendor.ngMetadata_core),angular.module("gj.Screen").directive("gjScreenClasses",["Screen",function(e){var t="__";return{restrict:"A",link:function(i,n){function o(){var i=[];e.isXs?(i.push(t+"screen-mobile"),i.push(t+"screen-xs")):e.isSm?(i.push(t+"screen-mobile"),i.push(t+"screen-sm-up"),i.push(t+"screen-sm")):e.isMd?(i.push(t+"screen-sm-up"),i.push(t+"screen-desktop"),i.push(t+"screen-md")):e.isLg&&(i.push(t+"screen-sm-up"),i.push(t+"screen-desktop"),i.push(t+"screen-lg")),a.length&&n.removeClass(a.join(" ")),a=i,n.addClass(a.join(" "))}var a=[];o(),e.setResizeSpy(i,o)}}}]),angular.module("gj.Screen").directive("gjScreenContext",["$parse","Screen",function(e,t){return{restrict:"A",link:function(i,n,o){i.$watch(e(o.gjScreenContext),function(e){t.setContext(e?n:!1),i.$applyAsync(function(){t.recalculate()})})}}}]),angular.module("gj.Growls",[]),angular.module("gj.Growls").directive("gjGrowlMessage",["$timeout","$transition","Screen","Growls",function(e,t,i,n){return{restrict:"A",template:'<div ng-class="::{ \'growl-clickable\': message.onclick, \'growl-has-icon\': message.icon }" ng-mouseover="onMouseover()" ng-mouseout="onMouseout()" ng-click="onClick( $event )"> <a class="growl-close" ng-click="remove( $event )"> <span class="jolticon jolticon-remove"></span> </a> <div class="growl-inner" gj-growl-message-templated="::!!message.scope"> <div class="growl-icon" ng-if="::message.icon"> <img class="img-responsive" ng-src="{{ ::message.icon }}" alt=""> </div> <div class="growl-content"> <h4 ng-show="::message.title">{{ ::message.title }}</h4> <p>{{ ::message.message }}</p> </div> </div> </div> ',scope:{message:"=gjGrowlMessage",index:"=gjGrowlIndex"},compile:function(t){return i.isXs?t[0].classList.add("growl","anim-fade-enter-down","anim-back-leave-down"):t[0].classList.add("growl","anim-fade-enter-left","anim-fade-leave-left"),function(t,i,n){function o(){s=e(function(){t.remove()},2500)}function a(){s&&(e.cancel(s),s=void 0)}var r=i[0];r.classList.add("growl-type-"+t.message.type);var s;t.message.sticky?r.classList.add("growl-sticky"):(o(),t.onMouseover=a,t.onMouseout=o),t.onClick=function(e){t.message.onclick&&(t.message.onclick(e),t.remove(e))},t.remove=function(e){e&&e.stopPropagation(),t.message.close()}}}}}]),angular.module("gj.Growls").directive("gjGrowlMessageTemplated",["$parse",function(e){return{restrict:"A",link:function(t,i,n){if(e(n.gjGrowlMessageTemplated)(t)){var o=t.message;i.empty().append(o.element)}}}}]),angular.module("gj.Growls").directive("gjGrowls",["Growls",function(e){return{restrict:"E",template:'<div class="growl-container"> <div ng-repeat="message in Growls.messages" gj-growl-message="message" gj-growl-index="$index"></div> </div> ',link:function(t,i){t.Growls=e}}}]),angular.module("gj.Growls").service("Growls",["$rootScope","$controller","$compile","$q","$injector","$http","$templateCache","$window","Environment",function(e,t,i,n,o,a,r,s,l){function d(e){var t=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&t.push(n.when(o.invoke(e)))}),t}function c(e){var t=new s.Notification(e.title,{body:e.message,icon:e.icon});e.onclick&&(t.onclick=function(i){e.onclick(i),t.close()})}var u=this;this.incrementer=0,this.messages=[],this.add=function(){var o,s=arguments[0],p={};if(p=angular.isObject(arguments[1])?arguments[1]:{message:arguments[1],title:arguments[2]||void 0},p=_.defaults(p,{title:null,sticky:!1,onclick:null,icon:null}),p.title||("error"==s?p.title="Oh no!":"success"==s&&(p.title="Huzzah!")),l.isClient&&!p.controller)return c(p);++this.incrementer;var h={id:this.incrementer,type:s,title:p.title,message:p.message,sticky:p.sticky,icon:p.icon,onclick:p.onclick,close:function(){var e=_.findIndex(u.messages,{id:this.id});-1!==e&&u.remove(e)}};if(p.controller){h.scope=e.$new();var m={};m.$scope=h.scope,m.$growlMessage=h,o=p.template?n.when(p.template):a.get(angular.isFunction(p.templateUrl)?p.templateUrl():p.templateUrl,{cache:r}).then(function(e){return e.data});var g;o.then(function(e){return g=e,p.resolve?n.all(d(p.resolve)).then(function(e){var t=0;angular.forEach(p.resolve,function(i,n){m[n]=e[t],++t})}):void 0}).then(function(){var e=t(p.controller,m);h.scope.growlCtrl=e,h.element=angular.element("<div>"+g+"</div>"),h.element=i(h.element)(h.scope)})}else o=n.when();o.then(function(){u.messages.unshift(h)})},["success","info","error"].forEach(function(e){this[e]=function(){var t=Array.prototype.slice.call(arguments);t.unshift(e),this.add.apply(this,t)}},this),this.remove=function(e){u.messages.splice(e,1)}}]),angular.module("gj.Ad.Video",["gj.Analytics"]),angular.module("gj.Ad.Video").directive("gjAdVideo",function(){return{restrict:"E",template:'<div class="ad-video"> <h3 class="sans-margin">View ad. Be upset. Keep us running.</h3> <p class="text-muted">This ad supports the developer! Hang tight, your {{ ctrl.resourceLabel }} will begin in {{ ctrl.timeRemaining | time }}...</p> <div class="ad-video-player"> <div class="ad-video-player-play-overlay" ng-if="!ctrl.isAdPlaying" ng-click="ctrl.toggle()"> <div class="play-button-overlay"> <span class="jolticon jolticon-play"></span> </div> </div> <gj-loading loading-big="true" class="loading-centered"></gj-loading> <div class="ad-video-player-embed"> <video class="ad-video-player-embed-video"> <source src="/lib/gj-lib-client/components/ad/video/blank-video.mp4"> </video> </div> <div class="ad-video-player-ad-container"></div> </div> </div> ',scope:{resource:"@adResource",resourceId:"=adResourceId",resourceLabel:"=?adResourceLabel",trackingLabel:"@?eventTrackingLabel",onAdShown:"&?"},bindToController:!0,controllerAs:"ctrl",controller:["$q","$window","$document","$location","$element","$scope","Analytics","Environment","Ads",function(e,t,i,n,o,a,r,s,l){function d(){o[0].classList.add("ad-video-teardown"),p.adsManager&&p.adsManager.destroy(),h&&t.clearInterval(h)}var c,u,p=this;this.adsManager=void 0,this.isAdPlaying=!0;var h;this.timeRemaining=void 0,this.resourceLabel||(this.resourceLabel="game"),this.toggle=function(){p.isAdPlaying?(p.adsManager.pause(),p.isAdPlaying=!1):(p.adsManager.resume(),p.isAdPlaying=!0)};var m=i[0].createElement("script");m.type="text/javascript",m.async=!0;var g=i[0].head||i[0].getElementsByTagName("head")[0];g.appendChild(m);var f=e(function(e,t){m.onload=e,m.onerror=t});m.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",f.then(function(){return e(function(e,i){function d(n){a.$applyAsync(function(){function o(){p.timeRemaining=p.adsManager.getRemainingTime(),a.$digest()}p.adsManager=n.getAdsManager(c),p.adsManager.addEventListener(t.google.ima.AdErrorEvent.Type.AD_ERROR,m),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(){c.pause(),p.isAdPlaying=!0,a.$digest()}),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(){c.play(),p.isAdPlaying=!1,a.$digest()}),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.STARTED,function(){r.trackEvent(p.trackingLabel||"Video Ad","Started","IMA"),o(),h=t.setInterval(function(){o()},1e3)}),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.IMPRESSION,function(){l.sendBeacon(l.TYPE_VIDEO,p.resource,p.resourceId)}),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.CLICK,function(){r.trackEvent(p.trackingLabel||"Video Ad","Clicked","IMA"),p.toggle(),a.$digest()}),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.SKIPPED,function(t){r.trackEvent(p.trackingLabel||"Video Ad","Skipped","IMA"),e()}),p.adsManager.addEventListener(t.google.ima.AdEvent.Type.COMPLETE,function(){r.trackEvent(p.trackingLabel||"Video Ad","Completed","IMA"),e()});try{p.adsManager.init(910,512,t.google.ima.ViewMode.NORMAL),p.adsManager.start()}catch(s){i(s)}})}function m(e){i(e.getError())}c=o.find("video")[0],u=o[0].getElementsByClassName("ad-video-player-ad-container")[0];var g=new t.google.ima.AdDisplayContainer(u,c);g.initialize();var f=new t.google.ima.AdsLoader(g);f.getSettings().setVpaidAllowed(!0),f.addEventListener(t.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,d,!1),f.addEventListener(t.google.ima.AdErrorEvent.Type.AD_ERROR,m,!1);var v=new t.google.ima.AdsRequest;v.adTagUrl="development"==s.env?"https://pubads.g.doubleclick.net/gampad/ads?sz=640x360&iu=/6062/iab_vast_samples/skippable&ciu_szs=300x250,728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]":"https://pubads.g.doubleclick.net/gampad/ads?sz=854x480&iu=/27005478/web-video-browser&ciu_szs=300x60,300x250,728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params="+t.encodeURIComponent("ref_url="+t.encodeURIComponent(n.absUrl())),v.linearAdSlotWidth=910,v.linearAdSlotHeight=512,f.requestAds(v)})})["catch"](function(e){if(e.message)return void r.trackEvent(p.trackingLabel||"Video Ad","Ad Error",e.message);switch(e.getErrorCode()){case 303:r.trackEvent(p.trackingLabel||"Video Ad","No Ad",e.getMessage());break;case 403:r.trackEvent(p.trackingLabel||"Video Ad","Invalid Ad Format",e.getMessage());break;default:r.trackEvent(p.trackingLabel||"Video Ad","Ad Error",e.getErrorCode()+" - "+e.getMessage())}})["finally"](function(){d(),p.onAdShown&&p.onAdShown({})}),a.$on("$destroy",function(){d()})}]}}),angular.module("gj.Analytics",["gj.Environment"]),angular.module("gj.Analytics").directive("gjAnalyticsTrackClick",["$interpolate","Analytics",function(e,t){return{restrict:"A",link:function(i,n,o){n.on("click",function(){var n=e(o.gjAnalyticsTrackClick)(i);if(n){var a=n.split(":");t.trackEvent(a[0],a[1],a[2],a[3])}})}}}]),angular.module("gj.Analytics").directive("gjTrackEvent",["Analytics",function(e){return{restrict:"A",link:function(t,i,n){i.on("click",function(){var t=n.gjTrackEvent;if(t){var i=t.split(":");e.trackEvent(i[0],i[1],i[2],i[3])}})}}}]),angular.module("gj.Analytics").service("Analytics",["$rootScope","$log","$window","$location","$document","$timeout","$q","App","Environment",function(e,t,i,n,o,a,r,s,l){function d(){s.user&&s.user.id?"development"==l.buildType?console.log("Set tracking User ID: "+s.user.id):i.ga("set","&uid",s.user.id):"development"==l.buildType?console.log("Unset tracking User ID."):i.ga("set","&uid","")}function c(){return"production"==l.buildType&&s.user&&s.user.permission_level>0?!1:!0}function u(e){var t=!1;return i.setTimeout(e,1e3),function(){t||(t=!0,e())}}function p(e,t){if(!c())return void console.log("Skip tracking page view since not a normal user.");var a="send";if(t){var r=t.replace(/[\-_:]/g,"");a=r+"."+a,-1===_.indexOf(h.extraTrackers,t)&&(h.extraTrackers.push(t),"development"==l.buildType?console.log("Create new tracker: "+t):i.ga("create",t,"auto",{name:r}))}else t="";d(),e||(e=n.url());var s=o[0].title,u={page:e,title:s};"development"==l.buildType?console.log("Track page view: tracker("+t+") | "+JSON.stringify(u)):i.ga(a,"pageview",angular.extend({},u)),!t&&m&&p(null,m),t||(g=!0)}var h=this;this.extraTrackers=[];var m=null,g=!0;this.SOCIAL_NETWORK_FB="facebook",this.SOCIAL_NETWORK_TWITTER="twitter",this.SOCIAL_NETWORK_TWITCH="twitch",this.SOCIAL_NETWORK_YOUTUBE="youtube",this.SOCIAL_ACTION_LIKE="like",this.SOCIAL_ACTION_SHARE="share",this.SOCIAL_ACTION_SEND="send",this.SOCIAL_ACTION_TWEET="tweet",this.SOCIAL_ACTION_FOLLOW="follow",this.SOCIAL_ACTION_SUBSCRIBE="subscribe",this.SOCIAL_ACTION_UNSUBSCRIBE="unsubscribe",i.ga("set","forceSSL",!0),i.ga("set","checkProtocolTask",null),e.$on("$stateChangeStart",function(e){g=!1}),e.$on("$stateChangeSuccess",function(e,t){t&&t.redirectTo||t&&t.skipTrackPageview||h.trackPageview()}),this.trackPageview=function(e){a(function(){p(e)})},this.trackEvent=function(e,t,n,o){return r(function(a,r){if(!c())return console.log("Skip tracking event since not a normal user."),void a();d();var s={nonInteraction:1,hitCallback:u(a)};"development"==l.buildType?(console.log("Track event: "+e+":"+(t||"-")+":"+(n||"-")+":"+(o||"-")),a()):i.ga("send","event",e,t,n,o,s)})},this.trackSocial=function(e,t,n){return r(function(o,a){return c()?(d(),void("development"==l.buildType?(console.log("Track social event: "+e+":"+t+":"+n),o()):i.ga("send","social",e,t,n,{hitCallback:u(o)}))):(console.log("Skip tracking social event since not a normal user."),void o())})},this.trackTiming=function(e,n,o,a){return r(function(r,s){return c()?(t.info("Timing ("+e+(a?":"+a:"")+") "+n+" = "+o),void("production"==l.buildType?i.ga("send","timing",e,n,o,a,{hitCallback:u(r)}):r())):(console.log("Skip tracking timing event since not a normal user."),void r())})},this.setCurrentExperiment=function(e,t){return-1!=t&&"-1"!=t?c()?void("development"==l.buildType?console.log("Set new experiment: "+e+" = "+t):(i.ga("set","expId",e),i.ga("set","expVar",""+t))):void console.log("Skip setting experiment since not a normal user."):void 0},this.attachAdditionalPageTracker=function(e,t){"development"==l.buildType&&console.log("Attached additional tracker: "+t),m=t,e.$on("$destroy",function(){"development"==l.buildType&&console.log("Detached additional tracker: "+t),m=null}),g&&p(null,t)}}]),angular.module("gj.Referrer",[]),angular.module("gj.Referrer").run(["Referrer",function(e){e.init()}]).service("Referrer",["$rootScope","$document","$location",function(e,t,i){var n=!0,o=null,a=null,r=null;this.init=function(){t[0].referrer&&(r=t[0].referrer),e.$on("$stateChangeStart",function(){n||(a=r,r=o)}),e.$on("$stateChangeSuccess",function(){n=!1,o=i.absUrl()}),e.$on("$stateChangeError",function(){r=a})},this.get=function(){return r}}]),angular.module("gj.Api",[]),angular.module("gj.Api").service("Api",["$window","$http","$injector","Environment","Payload",function(e,t,i,n,o){var a=this;this.apiHost=n.apiHost,this.apiPath="/site-api",this.sendRequest=function(n,r,s){if(s=e._.defaults(s||{},{file:null,ignoreLoadingBar:!1,processPayload:!0,withCredentials:!0,sanitizeComplexData:!0,allowComplexData:[],detach:!1,apiHost:void 0,apiPath:void 0}),s.detach&&(s.ignoreLoadingBar=!0,s.ignorePayloadUser=!0,s.ignorePayloadVersion=!0,s.noErrorRedirect=!0),r){var l={};angular.forEach(r,function(e,t){angular.isUndefined(e)||(s.sanitizeComplexData?(s.allowComplexData&&-1!==s.allowComplexData.indexOf(t)||!angular.isFunction(e)&&!angular.isObject(e)&&!angular.isArray(e))&&(l[t]=e):l[t]=e)})}if(s.file){$upload=i.get("$upload"),angular.isArray(s.file)?s.fileFormDataName=s.file.length>1?"file[]":"file":(s.fileFormDataName=Object.keys(s.file),s.file=_.flatten(_.values(s.file)));var d=$upload.upload({method:"POST",url:(s.apiHost||a.apiHost)+(s.apiPath||a.apiPath)+n,data:l||void 0,file:s.file,fileFormDataName:s.fileFormDataName,withCredentials:s.withCredentials,ignoreLoadingBar:!0})}else var d=t({method:l?"POST":"GET",url:(s.apiHost||a.apiHost)+(s.apiPath||a.apiPath)+n,data:l||"",withCredentials:s.withCredentials,ignoreLoadingBar:s.ignoreLoadingBar});return s.processPayload?o.processResponse(d,s):d}}]),angular.module("gj.Payload",["gj.Environment"]),angular.module("gj.Payload").service("Payload",["App","Environment","$window","$location","$q","$rootScope","$state","$injector",function(e,t,i,n,o,a,r,s){function l(e,t){return e&&e.data?e.data.redirect?(n.url(e.data.redirect),!0):!1:void 0}function d(t,i){if(t&&t.data){var n=t.data;if(!i.ignorePayloadUser){if(s.has("User")&&angular.isDefined(n.user)){var o=s.get("User");angular.equals(n.user,e.user)||(e.user=null===n.user?null:new o(n.user))}a.$emit("Payload.userProcessed",!!e.user)}}}function c(e,t){if(s.has("Analytics")&&e&&e.data&&e.data.payload){var i=e.data.payload;angular.isDefined(i._experiment)&&i._experiment&&angular.isDefined(i._variation)&&-1!=i._variation&&s.get("Analytics").setCurrentExperiment(i._experiment,i._variation)}}var u=this;this.ERROR_NEW_VERSION="payload-new-version",this.ERROR_NOT_LOGGED="payload-not-logged",this.ERROR_REDIRECT="payload-redirect",this.ERROR_INVALID="payload-invalid",this.ERROR_HTTP_ERROR="payload-error",this.ERROR_OFFLINE="payload-offline";var p=[400,403,404,500],h=[];a.$on("$stateChangeError",function(e,t,i,n,o,a){u.handlePayloadError(e,t,i,n,o,a)}),this.processResponse=function(i,n){n=_.defaults(n||{},{ignorePayloadUser:!1,ignorePayloadVersion:!1,noErrorRedirect:!1});var r=o.defer();return i.then(function(i){var o=i.data;if(!l(i,r)){if(!n.ignorePayloadVersion&&!t.isClient&&o.ver!=e.ver){if(null!==e.ver)return r.reject({type:"payload",error:u.ERROR_NEW_VERSION});e.ver=o.ver}d(i,n),o.payload?(c(i,n),a.$emit("Payload.responseSuccess",i),r.resolve(o.payload)):r.reject(n.noErrorRedirect?i.data||null:{type:"payload",error:u.ERROR_INVALID,response:i.data||null})}},function(e){if(!l(e,r)){d(e,n);var t=a.$emit("Payload.responseError",e,n);return t.defaultPrevented?void r.resolve(e):void r.reject(n.noErrorRedirect?e:-1==e.status?{type:"payload",error:u.ERROR_OFFLINE,response:null}:401==e.status?{type:"payload",error:u.ERROR_NOT_LOGGED,response:e.data||null}:{type:"payload",error:u.ERROR_HTTP_ERROR,response:e.data||null,status:e.status||void 0})}},function(e){r.notify(e)}),r.promise},this.addErrorHandler=function(e){h.push(e)},this.removeErrorHandler=function(e){_.pull(h,e)},this.handlePayloadError=function(e,o,a,s,l,d){if(1==arguments.length&&(d=arguments[0],e={defaultPrevented:!1,preventDefault:function(){e.defaultPrevented=!0}},o=r.current,a=r.params),d&&d.type&&"payload"==d.type){if(h.length)for(var c=0;c<h.length&&h[c](e,o,a,s,l,d)!==!1;++c);if(!e.defaultPrevented)if(d.error==u.ERROR_NEW_VERSION)i.location.href=r.href(o,a,{absolute:!0});else if(d.error==u.ERROR_NOT_LOGGED)i.location.href=t.authBaseUrl+"/login?redirect="+encodeURIComponent(n.url());else if(d.error==u.ERROR_INVALID)r.go("error-500");else if(d.error!=u.ERROR_HTTP_ERROR||d.status&&-1==p.indexOf(d.status)){var m=r.href(o,a);r.go("error-offline",{retryUrl:m})}else r.go("error-"+(d.status||500))}}}]),angular.module("gj.Error",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){[{code:400,template:"/lib/gj-lib-client/components/error/error-400.html"},{code:403,template:"/lib/gj-lib-client/components/error/error-403.html"},{code:404,template:"/lib/gj-lib-client/components/error/error-404.html"},{code:500,template:"/lib/gj-lib-client/components/error/error-500.html"}].forEach(function(t){e.state("error-"+t.code,{templateUrl:t.template,resolve:{init:["$injector",function(e){return e.has("Translate")?e.get("Translate").loadSection("main"):void 0}]}})}),e.state("error-offline",{url:"/error-offline?retryUrl",template:'<section class="container page-error"> <div class="ararat"></div> <h1 translate="">Can\'t Connect</h1> <p><strong translate="">We are having trouble connecting to Game Jolt.</strong></p> <p translate="">Check your internet connection and try again.</p> <br> <p> <button class="btn btn-outline" ng-click="ctrl.retry()" translate=""> Retry </button> </p> <br> </section> ',controllerAs:"ctrl",controller:["$location","$stateParams",function(e,t){var i=decodeURIComponent(t.retryUrl);-1!==i.search(/^\#\!/)&&(i=i.substring(2)),this.retry=function(){e.url(i)}}],resolve:{init:["$injector",function(e){return e.has("Translate")?e.get("Translate").loadSection("main"):void 0}]}}),t.otherwise(function(e,t){return e.get("$state").go("error-404"),!0})}]),angular.module("gj.Loading",[]),angular.module("gj.Loading").directive("gjLoading",["$interpolate","$parse",function(e,t){return{restrict:"E",scope:!0,template:'<div class="loading" ng-class="{ \'loading-big\': isBig, \'loading-stationary\': isStationary, \'loading-bw\': noColor }"> <img ng-src="{{ loadingImg }}" alt="Loading" title="Loading..."> <span class="loading-label" ng-class="{ \'sr-only\': hideLabel }"> {{ ::label }} </span> </div> ',link:function(i,n,o){i.label=o.label?e(o.label)(i):"Loading...",i.hideLabel=o.hideLabel?t(o.hideLabel)(i):angular.isDefined(o.hideLabel),i.isBig=o.loadingBig?t(o.loadingBig)(i):angular.isDefined(o.loadingBig),i.noColor=o.loadingNoColor?t(o.loadingNoColor)(i):angular.isDefined(o.loadingNoColor),i.isStationary=o.loadingStationary?t(o.loadingStationary)(i):angular.isDefined(o.loadingStationary);var a={loading:"/lib/gj-lib-client/components/loading/loading.gif","loading-2x":"/lib/gj-lib-client/components/loading/loading-2x.gif","loading-bw":"/lib/gj-lib-client/components/loading/loading-bw.gif","loading-bw-2x":"/lib/gj-lib-client/components/loading/loading-bw-2x.gif","loading-stationary":"/lib/gj-lib-client/components/loading/loading-stationary.gif","loading-stationary-2x":"/lib/gj-lib-client/components/loading/loading-stationary-2x.gif","loading-stationary-bw":"/lib/gj-lib-client/components/loading/loading-stationary-bw.gif","loading-stationary-bw-2x":"/lib/gj-lib-client/components/loading/loading-stationary-bw-2x.gif"},r="loading"+(i.isStationary?"-stationary":"")+(i.noColor?"-bw":"")+(i.isBig?"-2x":"");i.loadingImg=a[r]}}}]),angular.module("gj.ExpandWhen",["ui.bootstrap.collapse"]),angular.module("gj.ExpandWhen").directive("gjExpandWhen",["$timeout","$transition","$parse",function(e,t,i){return{restrict:"EA",transclude:!0,scope:!0,template:'<div collapse="isCollapsed"><div ng-if="isTranscluded" class="clearfix" ng-transclude></div></div>',link:{pre:function(i,n,o){function a(e){i.isTranscluded=e,i.isCollapsed=!e,c=!0,i.isCollapsed||n[0].classList.add("is-expanded")}function r(){s&&(e.cancel(s),s=null),l&&(l.cancel(),l=null)}var s,l;i.isTranscluded=!1,i.isCollapsed=!1;var d=n.children(1),c=!1;i.$watch(o.gjExpandWhen,function(o){if(o){if(!c)return void a(o);r(),i.isTranscluded=!0,s=e(function(){s=null,i.isCollapsed=!1,n[0].classList.add("is-expanded")},100)}else{if(!c)return void a(o);r(),s=e(function(){s=null,i.isCollapsed=!0,n[0].classList.remove("is-expanded"),l=t(d),l.then(function(){l=null,i.isTranscluded=!1})},100)}})}}}}]),angular.module("gj.Form",["gj.ExpandWhen"]),angular.module("gj.Form").directive("gjFormCcExp",function(){function e(e){var t=e.replace(/[^\d]+/,""),i=parseInt(t.substring(0,2),10),n=parseInt("20"+t.substring(2,4),10);return{m:i,y:n}}function t(t){var i=e(t);return i.m<13&&i.m>0}return{restrict:"A",require:"ngModel",compile:function(i,n){return n.$set("pattern","[0-9]*"),function(i,n,o,a){a.$validators.ccExpInvalid=function(e,i){var n=e||i;return a.$isEmpty(n)?!0:t(n)},a.$validators.ccExpExpired=function(i,n){var o=i||n;if(a.$isEmpty(o))return!0;if(!t(o))return!0;var r=e(o);return Date.now()<new Date(r.y,r.m).getTime()}}}}}),angular.module("gj.Form").directive("controlError",["$interpolate",function(e){return{restrict:"EA",require:"^controlErrors",scope:{when:"@"},link:function(t,i,n,o){o.setMessageOverride(t.when,e(i.text())(t.$parent))}}}]),angular.module("gj.Form").directive("controlErrors",["$filter","$timeout",function(e,t){var i={required:"You must enter a {}.",server:"The {} you've entered is invalid.",pattern:"Please enter a valid {}.",url:"Please enter a valid URL.",filetype:"The chosen {} is the wrong type of file.",email:"Please enter a valid email address.",number:"Please enter a valid number.",currency:"Please enter a valid amount.",min:"The {} entered is too low.",max:"The {} entered is too high."};return{restrict:"EA",require:["^form","^formGroup","controlErrors"],transclude:!0,template:'<div class="clearfix" ng-repeat="(errorKey, message) in ctrl.errorMessages track by errorKey" gj-expand-when="((ctrl.ignoreDirty || ctrl.ngFormField.$dirty) && ctrl.ngFormField.$invalid && ctrl.ngFormField.$error[ errorKey ])"> <p class="help-block error" ng-class="{ above: ctrl.position == \'above\' }">{{ message }}</p> </div> <div ng-transclude="" style="display: none"></div> ',bindToController:{labelInput:"@label",position:"@",ignoreDirty:"="},scope:{},controllerAs:"ctrl",controller:["$scope",function(t){function n(){if(o.label){var t=o.formGroup.validationData;o.errorMessages=angular.copy(i),angular.forEach(t,function(i,n){switch(n){case"maxlength":o.errorMessages[n]="Please enter a {} shorter than or equal to "+e("number")(i)+" characters.";break;case"minlength":o.errorMessages[n]="Please enter a {} longer than or equal to "+e("number")(i)+" characters.";break;case"pattern":"urlPath"==i?o.errorMessages.pattern="Please use only letters, numbers, and hyphens (-).":"hashtag"==i?o.errorMessages.pattern="Please use only letters, numbers, and underscores (_).":"username"==i&&(o.errorMessages.pattern="Please use only letters, numbers, hyphens (-), periods (.), and underscores (_).");break;case"available":o.errorMessages.available="This {} is already in use.";break;case"filesize":o.errorMessages.filesize="The chosen {} exceeds the maximum file size of "+e("number")(i/1024/1024)+"MB.";break;case"width":case"height":var a=t.width,r=t.height;a&&r?o.errorMessages.dimensions="The dimensions of your {} must be exactly "+e("number")(a)+"x"+e("number")(r)+"px.":a?o.errorMessages.dimensions="The width of your {} must be exactly "+e("number")(a)+"px.":r&&(o.errorMessages.dimensions="The height of your {} must be exactly "+e("number")(r)+"px.");break;case"min-width":case"min-height":var a=t["min-width"],r=t["min-height"];a&&r?o.errorMessages.minDimensions="What is this, a center for ants!? The dimensions of your {} must be at least "+e("number")(a)+"x"+e("number")(r)+"px.":a?o.errorMessages.minDimensions="What is this, a center for ants!? The width of your {} must be at least "+e("number")(a)+"px.":r&&(o.errorMessages.minDimensions="What is this, a center for ants!? The height of your {} must be at least "+e("number")(r)+"px.");break;case"max-width":case"max-height":var a=t["max-width"],r=t["max-height"];a&&r?o.errorMessages.maxDimensions="Your {} is too large. The dimensions must be no greater than "+e("number")(a)+"x"+e("number")(r)+"px.":a?o.errorMessages.maxDimensions="Your {} is too wide. The width must be no greater than "+e("number")(a)+"px.":r&&(o.errorMessages.maxDimensions="Your {} is too tall. The height must be no greater than "+e("number")(r)+"px.");break;case"ratio":o.errorMessages.ratio="Your {} has an incorrect aspect ratio. Its width divided by height must be exactly "+e("number")(t.ratio)+".";break;case"min-ratio":o.errorMessages.minRatio="Your {} has an incorrect aspect ratio. Its width divided by height must be at least "+e("number")(t["min-ratio"])+".";break;case"max-ratio":o.errorMessages.maxRatio="Your {} has an incorrect aspect ratio. Its width divided by height must be no greater than "+e("number")(t["max-ratio"])+"."}}),o.errorMessages=angular.extend(o.errorMessages,o.errorMessageOverrides),angular.forEach(o.errorMessages,function(e,t){o.errorMessages[t]=e.replace(/\{\}/g,o.label)})}}var o=this;this.ngForm=null,this.formGroup=null,this.label="",this.errorMessageOverrides={},this.setMessageOverride=function(e,t){this.errorMessageOverrides[e]=t,n()};var a=t.$watch(function(){return o.ngForm[o.formGroup.name]},function(e){e&&(o.ngFormField=e,a())});t.$watch("ctrl.labelInput || ctrl.formGroup.label",function(e){o.labelInput!=e&&(e=e.toLowerCase()),o.label=e,n()}),t.$watchCollection(function(){return o.formGroup.validationData},function(){n()})}],link:{pre:function(e,t,i,n){var o=n[2];o.ngForm=n[0],o.formGroup=n[1]}}}}]),angular.module("gj.Form").directive("gjFormCurrencyInput",["currencyFilter",function(e){var t=/^[0-9]*(?:\.[0-9]{0,2})?$/;return{restrict:"A",require:"ngModel",link:function(e,i,n,o){o.$validators.currency=function(e,i){var n=e||i;return o.$isEmpty(n)||t.test(n)}}}}]),angular.module("gj.Form").directive("gjFocusWhen",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(i,n,o){function a(){e(function(){n[0].focus()},0,!1)}o.gjFocusWhen?i.$watch(t(o.gjFocusWhen),function(e,t){e&&a()}):a()}}}]),angular.module("gj.Form").directive("formControl",["$compile",function(e){var t={urlPath:/^[\w\-]+$/,hashtag:/^[\w\_]+$/,username:/^[\w\-\.]+$/,gaTrackingId:/^UA\-[0-9]+\-[0-9]+$/,semver:/^v?(?:0|[1-9][0-9]*)\.(?:0|[1-9][0-9]*)\.(?:0|[1-9][0-9]*)(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?$/i};return{priority:1e3,terminal:!0,restrict:"A",require:["^gjForm","^formGroup"],compile:function(i,n){var o=!1;return n.formControl&&-1===["radio","checkbox","file","upload","crop"].indexOf(n.formControl)?o=!0:n.formControl||(o=!0),o&&i.addClass("form-control"),n.formControl&&"upload"!=n.formControl&&"crop"!=n.formControl&&i.attr("type",n.formControl),i.removeAttr("form-control"),i.attr("form-control-compiled",!0),"checkbox"!=n.formControl&&i.attr("ng-required","isRequired"),n.gjFormServerValidation||i.attr("gj-form-server-validation","formState.serverErrors"),{post:function(i,n,o,a){var r=a[0],s=a[1],l=!0;-1!==["radio","checkbox"].indexOf(o.type)&&(l=!1),l&&n.attr("id",r.name+"-"+s.name),n.attr("name",s.name),angular.isUndefined(o.ngModel)&&n.attr("ng-model",r.formModel+"['"+s.name+"']"),angular.isDefined(o.ngMaxlength)&&s.setValidationData("maxlength",o.ngMaxlength),angular.isDefined(o.ngMinlength)&&s.setValidationData("minlength",o.ngMinlength),angular.isDefined(o.gjFormValidateAvailability)&&s.setValidationData("available",!0),angular.isDefined(o.gjPattern)&&angular.isDefined(t[o.gjPattern])&&(n.attr("ng-pattern",t[o.gjPattern]),s.setValidationData("pattern",o.gjPattern)),e(n)(i)}}}}}]).directive("formControlCompiled",function(){return{restrict:"A",require:["^gjForm","^formGroup"],link:function(e,t,i,n){var o=(n[0],n[1]);e.$watch(function(e){return o.isRequired},function(t){e.isRequired=t})}}}),angular.module("gj.Form").directive("gjForm",function(){return{restrict:"EA",require:["gjForm","form"],controller:["$scope","$element","$attrs",function(e,t,i){i.$set("novalidate","novalidate"),this.name=i.name,this.formModel=i.gjForm}],controllerAs:"gjFormCtrl",link:function(e,t,i,n){var o=n[1];e.$on("gjForm.onSubmitted",function(){o.$setPristine()})}}}),angular.module("gj.Form").directive("gjFormErrorBlock",function(){return{restrict:"A",scope:{formField:"=gjFormErrorBlock",errorLabels:"=gjErrorLabels",position:"@gjErrorPosition"},template:'<div class="clearfix" ng-repeat="(errorKey, label) in errorLabels" collapse="!(formField.$dirty && formField.$invalid && formField.$error[errorKey])"> <p class="help-block error" ng-class="{ above: position == \'above\' }">{{label}}</p> </div>'}}),angular.module("gj.Form").directive("formGroup",["$interpolate","$parse",function(e,t){function i(e){return e=e.replace(/(\-|_)/g," "),e=e.replace(/([a-z])([A-Z])/g,"$1 $2"),e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}return{restrict:"EA",require:["^gjForm","formGroup"],scope:!0,transclude:!0,template:'<label for="{{ gjFormCtrl.name }}-{{ formGroupCtrl.name }}" class="control-label" ng-class="formGroupCtrl.labelClass">{{ formGroupCtrl.label }}</label> ',controller:["$scope","$attrs",function(e,t){this.name=void 0,this.label=void 0,this.isRequired=!0,this.hideLabel=!1,this.labelClass="",this.labelClasses=[],this.validationData={},this.setValidationData=function(e,t){this.validationData[e]=t},this.removeValidationData=function(e){delete this.validationData[e]}}],controllerAs:"formGroupCtrl",link:function(n,o,a,r,s){function l(){var e=[];d.hideLabel&&e.push("sr-only"),e=e.concat(d.labelClasses),e=_.uniq(e),d.labelClass=e.join(" ")}var d=(r[0],r[1]);o.addClass("form-group"),d.name=e(a.name)(n),s(function(e){o.append(e)}),angular.isUndefined(a.label)?d.label=i(d.name):a.$observe("label",function(e){d.label=e}),n.$watch(t(a.optional),function(e){d.isRequired=angular.isDefined(e)?!e:!0,d.isRequired?o.removeClass("optional"):o.addClass("optional")}),n.$watch(t(a.hideLabel),function(e){d.hideLabel=e?!0:!1,l()}),angular.isDefined(a.labelClass)&&a.$observe("labelClass",function(e){d.labelClasses=e.split(" "),l()})}}}]),angular.module("gj.Form").directive("gjFormServerValidation",function(){return{restrict:"A",require:"ngModel",
link:function(e,t,i,n){e.$watchCollection(i.gjFormServerValidation,function(e){e&&angular.isDefined(i.name)&&angular.isDefined(e[i.name])&&(n.$setValidity("server",!1),n.$setDirty())}),n.$viewChangeListeners.push(function(){angular.isDefined(n.$error.server)&&n.$error.server&&(n.$setValidity("server",!0),angular.isDefined(e[i.gjFormServerValidation])&&angular.isDefined(i.name)&&angular.isDefined(e[i.gjFormServerValidation][i.name])&&delete e[i.gjFormServerValidation][i.name])})}}}),angular.module("gj.Form").factory("Form",["$injector","$timeout","$q",function(e,t,i){function n(i){var n=this;if(this.modelName=void 0,this.modelClass=void 0,this.resetOnSubmit=angular.isDefined(i.resetOnSubmit)?i.resetOnSubmit:!1,this.saveMethod="$save",this.controllerAs=i.controllerAs||"$ctrl",this.scope={formModel:"=?gjFormModel",submitHandler:"&gjFormSubmitHandler"},i.template&&(this.templateUrl=i.template),i.model){this.modelName=i.model,this.modelClass=e.get(i.model);var o="=?gj"+i.model.replace(/_/g,"");this.scope.baseModel=o}angular.isDefined(i.saveMethod)&&(this.saveMethod=i.saveMethod),this.link={},this.link.pre=function(e){var i=e.formState&&e.formState.isShowingSuccess?!0:!1;e.formState={isProcessing:!1,isShowingSuccess:i,serverErrors:{}},e.method="add",n.modelName&&n.modelClass&&(e[n.modelName]=n.modelClass),e.$on("$destroy",function(){n.successShowPromise&&(t.cancel(n.successShowPromise),n.successShowPromise=void 0)}),n._init(e),e.onSubmit=function(){return n._onSubmit(e)}}}return n.prototype.restrict="E",n.prototype._init=function(e){e.baseModel?(e.method="edit",e.formModel=this.modelClass?new this.modelClass(e.baseModel):angular.copy(e.baseModel)):e.formModel=this.modelClass?new this.modelClass:{},this.onInit&&this.onInit(e)},n.prototype._onSubmit=function(e){var t,n=this;return e[e.gjFormCtrl.name].$valid&&!e.formState.isProcessing?(e.formState.isProcessing=!0,e.formState.progress=void 0,this.onSubmit?e.formState.progress=this.onSubmit(e).then(function(e){return e.success===!1?i.reject(e):void(t=e)}):this.modelClass&&this.saveMethod&&(e.formState.progress=e.formModel[this.saveMethod]().then(function(i){t=i,e.baseModel&&angular.extend(e.baseModel,e.formModel)})),e.formState.progress.then(function(){n.onSubmitSuccess&&n.onSubmitSuccess(e,t),angular.isDefined(e.submitHandler)&&e.submitHandler({formModel:e.formModel,$response:t}),e.formState.isProcessing=!1,e.formState.serverErrors={},e.$broadcast("gjForm.onSubmitted",{}),n._showSuccess(e),n.resetOnSubmit&&n._init(e)})["catch"](function(t){t&&t.errors&&(e.formState.serverErrors=t.errors),e.formState.isProcessing=!1})):void 0},n.prototype._showSuccess=function(e){this.successShowPromise&&t.cancel(this.successShowPromise),e.formState.isShowingSuccess=!0,this.successShowPromise=t(function(){e.formState.isShowingSuccess=!1,this.successShowPromise=void 0},1e3)},n}]),angular.module("gj.Form").directive("gjFormSubmitButton",["$animate",function(e){return{restrict:"A",require:"^gjForm",scope:!0,link:function(t,i,n,o){var a=angular.element('<span class="jolticon jolticon-check gj-form-success-icon"></span>');t.$watch("formState.isShowingSuccess",function(t){if(t){var n=i.children();e.enter(a,i,n[n.length-1])}else e.leave(a)})}}}]),angular.module("gj.Form").directive("gjFormValidateAvailability",["$http","$timeout","$q","Api",function(e,t,i,n){return{restrict:"A",require:"ngModel",link:function(o,a,r,s){var l=void 0;t(function(){l=s.$viewValue||s.$modelValue||""}),s.$asyncValidators.available=function(t,o){var a=t||o;return angular.isUndefined(l)||s.$isEmpty(a)||l===a?i.when(!0):e({method:"POST",url:n.apiHost+n.apiPath+r.gjFormValidateAvailability,data:{value:a},withCredentials:!0,ignoreLoadingBar:!0})}}}}]),angular.module("gj.Form").directive("inputGroupAddon",["$rootScope","Screen",function(e,t){return{restrict:"EA",require:"^inputGroup",link:function(e,i,n,o){function a(){t.isXs?(o.isHidden=!0,i.addClass("sr-only")):(o.isHidden=!1,i.removeClass("sr-only"))}i.addClass("input-group-addon"),angular.isDefined(n.addonHiddenXs)&&(a(),t.setResizeSpy(e,a))}}}]),angular.module("gj.Form").directive("inputGroup",function(){return{restrict:"EA",require:"inputGroup",controller:function(){this.isHidden=!1},link:function(e,t,i,n){t.addClass("input-group"),e.$watch(function(){return n.isHidden},function(e){e?t.removeClass("input-group"):t.addClass("input-group")})}}}),angular.module("gj.Form").component("gjFormLoader",{bindings:{url:"@",onLoaded:"&"},templateUrl:"",controller:["Api",function(e){var t=this;e.sendRequest(t.url,null,{detach:!0}).then(function(e){t.isLoaded=!0,t.onLoaded({$payload:e})})}]}),angular.module("gj.Form").directive("gjSelectOnFocus",["$timeout",function(e){return{restrict:"A",link:function(t,i){i.on("focus",function(){e(function(){i.select()},0,!1)})}}}]),angular.module("gj.History",[]),window.addEventListener("popstate",function(){window._gjHistoryPop&&window._gjHistoryPop()}),angular.module("gj.History").run(["$rootScope","$state","$window","$location","History",function(e,t,i,n,o){e.$on("$stateChangeStart",function(){arguments[1]&&(o.futureState=[arguments[1],arguments[2]])}),e.$on("$stateChangeSuccess",function(){o._reset()}),e.$on("$stateChangeError",function(){o._reset()})}]).service("History",["$q","$window","$timeout","$rootScope","$state","$location",function(e,t,i,n,o,a){var r=this;this.inHistorical=!1,this.futureState=null,t._gjHistoryPop=function(){r.inHistorical=!0},this._reset=function(){i(function(){r.inHistorical=!1,r.futureState=null})}}]),angular.module("gj.Tooltip",["ui.bootstrap.tooltip","ui.bootstrap.tooltip.tpls"]).config(["$tooltipProvider",function(e){e.options({appendToBody:!0})}]),angular.module("gj.Tooltip").directive("gjTooltip",["$compile","$interpolate","Screen",function(e,t,i){return{priority:1e5,terminal:!0,restrict:"A",scope:!0,link:{pre:function(n,o,a){n.Screen||(n.Screen=i),o.removeAttr("gj-tooltip"),n._tooltip="";var r=t(a.gjTooltip);n.$watch(function(){return r(n.$parent)},function(e){n._tooltip=e}),o.attr("tooltip",'{{ (!Screen.isXs ? (_tooltip) : "") }}'),e(o)(n)}}}}]),angular.module("gj.MediaItem",[]),angular.module("gj.MediaItem").factory("MediaItem",["Model",function(e){function t(e){e&&angular.extend(this,e)}return t.TYPE_GAME_THUMBNAIL="game-thumbnail",t.TYPE_GAME_HEADER="game-header",t.TYPE_GAME_SCREENSHOT="game-screenshot",t.TYPE_GAME_TROPHY="game-trophy",t.TYPE_FIRESIDE_POST_HEADER="fireside-post-header",t.TYPE_FIRESIDE_POST_IMAGE="fireside-post-image",t.TYPE_FEATURED_HEADER="featured-header",t.TYPE_SITES_THEME_IMAGE="sites-theme-image",t.TYPE_SITES_CONTENT_IMAGE="sites-content-image",t.STATUS_ACTIVE="active",t.STATUS_REMOVED="removed",t.prototype.getDimensions=function(e,t,i){if(!e&&!t)return{width:this.width,height:this.height};if(i&&i.force&&e&&t)return{width:e,height:t};var n,o,a=this.height/this.width;return i&&i.force?(n=e||o/a,o=t||n*a):e&&t?(n=Math.min(this.width,e),o=n*a,o>t&&(o=t,n=o/a)):e&&!t?(n=Math.min(this.width,e),o=n*a):!e&&t&&(o=Math.min(this.height,t),n=o/a),{width:n,height:o}},t.prototype.getCrop=function(){return this.crop_end_x&&this.crop_end_y?{x:this.crop_start_x,y:this.crop_start_y,x2:this.crop_end_x,y2:this.crop_end_y}:null},t.prototype.$save=function(){if(this.type!=t.TYPE_FIRESIDE_POST_IMAGE&&this.type!=t.TYPE_FIRESIDE_POST_HEADER)throw new Error("Can only save fireside media items.");return this.id?void 0:this.$_save("/fireside/dash/posts/media/upload/"+this.post_id+"/"+this.type,"mediaItem",{file:this.file})},t.prototype.$remove=function(){if(this.type!=t.TYPE_FIRESIDE_POST_IMAGE&&this.type!=t.TYPE_FIRESIDE_POST_HEADER)throw new Error("Can only save fireside media items.");return this.$_remove("/fireside/dash/posts/media/remove/"+this.id)},e.create(t)}]),angular.module("gj.Game.Screenshot",["gj.Model","gj.MediaItem"]),angular.module("gj.Game.Screenshot").factory("Game_Screenshot",["$q","Model","MediaItem","Api",function(e,t,i,n){function o(e){e&&angular.extend(this,e),this.media_item&&(this.media_item=new i(this.media_item))}return o.prototype.getUrl=function(e){return e.getUrl()+"#screenshot-"+this.id},o.prototype.$save=function(){return this.id?this.$_save("/web/dash/developer/games/media/save/image/"+this.game_id+"/"+this.id,"gameScreenshot"):n.sendRequest("/web/dash/developer/games/media/save/image/"+this.game_id,this,{file:this.file}).then(function(t){return t.success?t:e.reject(t)})},o.prototype.$remove=function(){return this.$_remove("/web/dash/developer/games/media/remove/image/"+this.game_id+"/"+this.id)},t.create(o)}]),angular.module("gj.Game.Video",["gj.Model"]),angular.module("gj.Game.Video").factory("Game_Video",["Model",function(e){function t(e){e&&angular.extend(this,e)}return t.TYPE_YOUTUBE="youtube",t.TYPE_VIMEO="vimeo",t.REGEX={VIDEO:/^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/|vimeo\.com\/)([a-zA-Z0-9_\-]+)(\S*)$/i,YOUTUBE:/^(https?:\/\/)?(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_\-]+)(\S*)$/i,VIMEO:/^(https?:\/\/)?(www\.)?(vimeo\.com\/)([a-zA-Z0-9_\-]+)(\S*)$/i},t.prototype.getUrl=function(e){return e.getUrl()+"#video-"+this.id},t.prototype.$save=function(){return this.id?this.$_save("/web/dash/developer/games/media/save/video/"+this.game_id+"/"+this.id,"gameVideo"):this.$_save("/web/dash/developer/games/media/save/video/"+this.game_id,"gameVideo")},t.prototype.$remove=function(){return this.$_remove("/web/dash/developer/games/media/remove/video/"+this.game_id+"/"+this.id)},e.create(t)}]),angular.module("gj.Game",["gj.Model","gj.User","gj.MediaItem"]),angular.module("gj.Game").factory("Game",["$state","$injector","$q","Api","App","Model","Environment","User","MediaItem",function(e,t,i,n,o,a,r,s,l){function d(e){if(e&&(angular.extend(this,e),e.developer&&angular.isObject(e.developer)&&(this.developer=new s(e.developer)),e.thumbnail_media_item&&angular.isObject(e.thumbnail_media_item)&&(this.thumbnail_media_item=new l(e.thumbnail_media_item)),e.header_media_item&&angular.isObject(e.header_media_item)&&(this.header_media_item=new l(e.header_media_item))),this._has_cover=!!this.header_media_item,this.is_published=!1,this.status==d.STATUS_VISIBLE&&(this.is_published=!0),this._is_finished=this.development_status==d.DEVELOPMENT_STATUS_FINISHED,this._is_wip=this.development_status==d.DEVELOPMENT_STATUS_WIP,this._is_devlog=this.development_status==d.DEVELOPMENT_STATUS_DEVLOG,this._has_packages=!1,this.compatibility)for(var i=Object.keys(this.compatibility),n=0;n<i.length;++n)if("id"!=i[n]&&"game_id"!=i[n]){this._has_packages=!0;break}this._should_show_ads=!0,this.ads_enabled?this.sellable&&"free"!=this.sellable.type&&(this._should_show_ads=!1):this._should_show_ads=!1,this.sellable&&"free"!=this.sellable.type&&o.user&&this.developer&&o.user.id==this.developer.id&&(this.sellable.is_owned=!0),this._can_buy_primary_sellable=!1,this.sellable&&"paid"==this.sellable.type&&!this.sellable.is_owned&&(this._can_buy_primary_sellable=!0),t.has("Registry")&&t.get("Registry").store("Game",this)}return t.has("Registry")&&t.get("Registry").setConfig("Game",{maxItems:100}),d.STATUS_HIDDEN=0,d.STATUS_VISIBLE=1,d.STATUS_REMOVED=2,d.DEVELOPMENT_STATUS_FINISHED=1,d.DEVELOPMENT_STATUS_WIP=2,d.DEVELOPMENT_STATUS_CANCELED=3,d.DEVELOPMENT_STATUS_DEVLOG=4,d.prototype.getSref=function(e,t){var i="";return i="dashboard"==e?"dashboard.developer.games.manage.game.overview":"edit"==e?"dashboard.developer.games.manage.game.details":"discover.games.view.overview",t&&(i+="( "+angular.toJson(this.getSrefParams(e))+" )"),i},d.prototype.getSrefParams=function(e){return-1!==["dashboard","edit"].indexOf(e)?{id:this.id}:{id:this.id,category:this.category_slug,slug:this.slug}},d.prototype.getUrl=function(t){return"soundtrack"==t?"/games/"+this.slug+"/"+this.id+"/download/soundtrack":e.href(this.getSref(t),this.getSrefParams(t))},d.prototype.hasDesktopSupport=function(){var e=this.compatibility;return e.os_windows||e.os_windows_64||e.os_mac||e.os_mac_64||e.os_linux||e.os_linux_64},d.prototype.hasBrowserSupport=function(){var e=this.compatibility;return e.type_html||e.type_flash||e.type_unity||e.type_applet||e.type_silverlight},d.checkDeviceSupport=function(e,t,i){return e["os_"+t]?!0:i&&"64"!=i||!e["os_"+t+"_64"]?!1:!0},d.prototype.canInstall=function(e,t){return this.hasDesktopSupport()?d.checkDeviceSupport(this.compatibility,e,t):!1},d.pluckInstallableBuilds=function(e,t,i){var n=[];return e.forEach(function(e){(!e._sellable||"paid"!=e._sellable.type||e._sellable.is_owned)&&e._builds.forEach(function(e){d.checkDeviceSupport(e,t,i)&&n.push(e)})}),n},d.pluckBrowserBuilds=function(e){var t=[];return e.forEach(function(e){e._builds.forEach(function(e){e.isBrowserBased()&&t.push(e)})}),t},d.pluckRomBuilds=function(e){var t=[];return e.forEach(function(e){e._builds.forEach(function(e){e.isRom()&&t.push(e)})}),t},d.chooseBestBuild=function(e,t,i){var n,o=_.sortBy(e,function(e){return e._release.sort});n={},n["os_"+t]=!0;var a=_.find(o,n);n={},n["os_"+t+"_64"]=!0;var r=_.find(o,n);return"64"==i&&r&&(!a||r._release.sort<=a._release.sort)?r:a?a:e[0]},d.prototype.$follow=function(){var e=this;return n.sendRequest("/web/library/games/add/followed",{game_id:this.id}).then(function(t){return e.is_following=!0,++e.follower_count,t})},d.prototype.$unfollow=function(){var e=this;return this.$_remove("/web/library/games/remove/followed/"+this.id).then(function(t){return e.is_following=!1,--e.follower_count,t})},d.prototype.$save=function(){return this.id?this.$_save("/web/dash/developer/games/save/"+this.id,"game"):this.$_save("/web/dash/developer/games/save","game")},d.prototype.$saveDescription=function(){return this.$_save("/web/dash/developer/games/description/save/"+this.id,"game")},d.prototype.$saveMaturity=function(){return this.$_save("/web/dash/developer/games/maturity/save/"+this.id,"game")},d.prototype.$saveThumbnail=function(){return this.$_save("/web/dash/developer/games/thumbnail/save/"+this.id,"game",{file:this.file,allowComplexData:["crop"]})},d.prototype.$saveHeader=function(){return this.$_save("/web/dash/developer/games/header/save/"+this.id,"game",{file:this.file})},d.prototype.$clearHeader=function(){return this.$_save("/web/dash/developer/games/header/clear/"+this.id,"game")},d.prototype.$saveSettings=function(){return this.$_save("/web/dash/developer/games/settings/save/"+this.id,"game")},d.prototype.$setStatus=function(e){return this.$_save("/web/dash/developer/games/set-status/"+this.id+"/"+e,"game")},d.prototype.$setDevStage=function(e){return this.$_save("/web/dash/developer/games/set-dev-stage/"+this.id+"/"+e,"game")},d.prototype.$setCanceled=function(e){return this.$_save("/web/dash/developer/games/set-canceled/"+this.id+"/"+(e?"1":"0"),"game")},d.prototype.$remove=function(e){return this.$_remove("/web/dash/developer/games/remove/"+this.id)},a.create(d)}]),angular.module("gj.User",["gj.Model"]),angular.module("gj.User").factory("User",["Api","Model",function(e,t){function i(e){e&&angular.extend(this,e),this.type==i.TYPE_GAMER?this.is_gamer=!0:this.type==i.TYPE_DEVELOPER&&(this.is_developer=!0)}return i.TYPE_GAMER="User",i.TYPE_DEVELOPER="Developer",i.touch=function(){return e.sendRequest("/web/touch")},i.prototype.$save=function(){return this.$_save("/web/dash/profile/save","user")},i.prototype.$saveEmailPreferences=function(){return this.$_save("/web/dash/email-preferences/save","user")},i.prototype.$saveFireside=function(){return this.$_save("/fireside/dash/profile/save","user")},i.prototype.$saveFiresideSettings=function(){return this.$_save("/fireside/dash/settings/save","user")},i.prototype.$unlinkAccount=function(e){return this.$_save("/web/dash/linked-accounts/unlink/"+e,"user")},t.create(i)}]),angular.module("gj.Sellable",["gj.Model","gj.Sellable.Pricing"]),angular.module("gj.Sellable").factory("Sellable",["Model","Sellable_Pricing",function(e,t){function i(e){e&&(angular.extend(this,e),e.pricings&&(this.pricings=t.populate(e.pricings)))}return e.create(i)}]),angular.module("gj.Sellable.Pricing",["gj.Model"]),angular.module("gj.Sellable.Pricing").factory("Sellable_Pricing",["Model",function(e){function t(e){e&&angular.extend(this,e)}return t.getOriginalPricing=function(e){return Array.isArray(e)?e[0].promotional?e[1]:e[0]:void 0},t.getPromotionalPricing=function(e){return Array.isArray(e)&&e[0].promotional?e[0]:void 0},e.create(t)}]),angular.module("gj.Game.Release",["gj.Model"]),angular.module("gj.Game.Release").factory("Game_Release",["Api","Model",function(e,t){function i(e){e&&angular.extend(this,e)}return i.STATUS_HIDDEN="hidden",i.STATUS_PUBLISHED="published",i.STATUS_REMOVED="removed",i.prototype.$save=function(){return this.id?this.$_save("/web/dash/developer/games/releases/save/"+this.game_id+"/"+this.game_package_id+"/"+this.id,"gameRelease"):this.$_save("/web/dash/developer/games/releases/save/"+this.game_id+"/"+this.game_package_id,"gameRelease")},i.prototype.$publish=function(e){return this.$_save("/web/dash/developer/games/releases/publish/"+this.game_id+"/"+this.game_package_id+"/"+this.id,"gameRelease").then(function(t){return e&&t.game&&e.assign(t.game),t})},i.prototype.$unpublish=function(e){return this.$_save("/web/dash/developer/games/releases/unpublish/"+this.game_id+"/"+this.game_package_id+"/"+this.id,"gameRelease").then(function(t){return e&&t.game&&e.assign(t.game),t})},i.prototype.$remove=function(e){return this.$_remove("/web/dash/developer/games/releases/remove/"+this.game_id+"/"+this.game_package_id+"/"+this.id).then(function(t){return e&&t.game&&e.assign(t.game),t})},t.create(i)}]),angular.module("gj.Game.Build",["gj.Model","gj.Game.Build.File","gj.Game.Build.Param"]),angular.module("gj.Game.Build").factory("Game_Build",["Api","Model","Game_Build_File","Game_Build_Param",function(e,t,i,n){function o(e){e&&(angular.extend(this,e),e.primary_file&&(this.primary_file=new i(e.primary_file)),this.params=[],e.params&&angular.isArray(e.params)&&e.params.length&&(this.params=n.populate(e.params)),this.errors&&angular.isString(this.errors)&&(this.errors=this.errors.split(",")))}return o.TYPE_DOWNLOADABLE="downloadable",o.TYPE_HTML="html",o.TYPE_FLASH="flash",o.TYPE_SILVERLIGHT="silverlight",o.TYPE_UNITY="unity",o.TYPE_APPLET="applet",o.TYPE_ROM="rom",o.STATUS_ADDING="adding",o.STATUS_ACTIVE="active",o.STATUS_REMOVED="removed",o.ERROR_MISSING_FIELDS="missing-fields",o.ERROR_LAUNCH_OPTIONS="launch-options",o.browserTypes=[o.TYPE_HTML,o.TYPE_FLASH,o.TYPE_SILVERLIGHT,o.TYPE_UNITY,o.TYPE_APPLET],o.EMULATOR_GBA="gba",o.EMULATOR_GBC="gbc",o.EMULATOR_GB="gb",o.EMULATOR_NES="nes",o.EMULATOR_VBOY="vb",o.EMULATOR_GENESIS="md",o.EMULATOR_SNES="snes",o.EMULATOR_ZX="zx",o.EMULATOR_MSX="msx",o.EMULATOR_ATARI2600="atari2600",o.EMULATOR_C64="c64",o.EMULATOR_CPC="cpc",o.prototype.isBrowserBased=function(){return-1!=o.browserTypes.indexOf(this.type)},o.prototype.isRom=function(){return this.type==o.TYPE_ROM},o.prototype.hasError=function(e){return this.errors&&-1!==this.errors.indexOf(e)},o.prototype.getDownloadUrl=function(t){t=t||{};var i={};return t.key&&(i.key=t.key),e.sendRequest("/web/discover/games/builds/get-download-url/"+this.id,i)},o.prototype.$save=function(){var e=[this.game_id,this.game_package_id,this.game_release_id];return this.id?(e.push(this.id),this.$_save("/web/dash/developer/games/builds/save/"+e.join("/"),"gameBuild")):this.$_save("/web/dash/developer/games/builds/save/"+e.join("/"),"gameBuild",{file:this.file})},o.prototype.$remove=function(e){var t=[this.game_id,this.game_package_id,this.game_release_id,this.id];return this.$_remove("/web/dash/developer/games/builds/remove/"+t.join("/")).then(function(t){return e&&t.game&&e.assign(t.game),t})},t.create(o)}]),angular.module("gj.Game.Build.File",["gj.Model"]),angular.module("gj.Game.Build.File").factory("Game_Build_File",["Model",function(e){function t(e){e&&angular.extend(this,e)}return e.create(t)}]),angular.module("gj.Game.Build.Param",["gj.Model"]),angular.module("gj.Game.Build.Param").factory("Game_Build_Param",["Model",function(e){function t(e){e&&angular.extend(this,e)}return e.create(t)}]),angular.module("gj.Game.Build.LaunchOption",["gj.Model"]),angular.module("gj.Game.Build.LaunchOption").factory("Game_Build_LaunchOption",["Model",function(e){function t(e){e&&angular.extend(this,e)}return t.OS_WINDOWS="windows",t.OS_WINDOWS_64="windows_64",t.OS_MAC="mac",t.OS_MAC_64="mac_64",t.OS_LINUX="linux",t.OS_LINUX_64="linux_64",t.LAUNCHABLE_PLATFORMS=[t.OS_WINDOWS,t.OS_WINDOWS_64,t.OS_MAC,t.OS_MAC_64,t.OS_LINUX,t.OS_LINUX_64],e.create(t)}]),angular.module("gj.Game.Package",["gj.Model","gj.Sellable","gj.Game.Release","gj.Game.Build","gj.Game.Build.LaunchOption"]),angular.module("gj.Game.Package").factory("Game_Package",["$q","Api","App","Model","Game_Release","Game_Build","Game_Build_LaunchOption","Sellable",function(e,t,i,n,o,a,r,s){function l(e){e&&angular.extend(this,e)}return l.STATUS_HIDDEN="hidden",l.STATUS_ACTIVE="active",l.STATUS_REMOVED="removed",l.VISIBILITY_PRIVATE="private",l.VISIBILITY_PUBLIC="public",l.prototype.shouldShowNamePrice=function(){return this._sellable&&"pwyw"==this._sellable.type&&!this._sellable.is_owned},l.$saveSort=function(e,i){return t.sendRequest("/web/dash/developer/games/packages/save-sort/"+e,i)},l.processPackagePayload=function(e){var t={};t.packages=e.packages?l.populate(e.packages):[],t.releases=e.releases?o.populate(e.releases):[],t.builds=e.builds?a.populate(e.builds):[],t.launchOptions=e.launchOptions?r.populate(e.launchOptions):[],t.sellables=e.sellables?s.populate(e.sellables):[];for(var i,n=_.indexBy(t.packages,"id"),d=_.indexBy(t.releases,"id"),c=_.indexBy(t.sellables,"game_package_id"),i=0;i<t.packages.length;++i){var u=t.packages[i];u._releases=_.where(t.releases,{game_package_id:u.id}),u._builds=_.where(t.builds,{game_package_id:u.id}),u._sellable=c[u.id],u.is_game_owner&&u._sellable&&(u._sellable.is_owned=!0)}for(var i=0;i<t.releases.length;++i){var p=t.releases[i];p._package=n[p.game_package_id],p._builds=_.where(p._package._builds,{game_release_id:p.id})}for(var i=0;i<t.builds.length;++i){var h=t.builds[i];h._package=n[h.game_package_id],h._release=d[h.game_release_id],h._launch_options=_.where(t.launchOptions,{game_build_id:h.id})}return t},l.prototype.$save=function(){return this.id?this.$_save("/web/dash/developer/games/packages/save/"+this.game_id+"/"+this.id,"gamePackage"):this.$_save("/web/dash/developer/games/packages/save/"+this.game_id,"gamePackage")},l.prototype.$remove=function(e){return this.$_remove("/web/dash/developer/games/packages/remove/"+this.game_id+"/"+this.id).then(function(t){return e&&t.game&&e.assign(t.game),t})},n.create(l)}]),angular.module("gj.Game.Package.Card",["gj.Game.Package","gj.Game.PlayModal","gj.Analytics","gj.Currency","gj.Countdown"]),angular.module("gj.Game.Package.Card").directive("gjGamePackageCardButtons",function(){return{restrict:"E",require:"^gjGamePackageCard",scope:!0,template:'<button class="btn btn-primary-outline btn-block-xs" ng-if="::ctrl.browserBuild" ng-click="ctrl.buildClick( ctrl.browserBuild )"> <span class="jolticon jolticon-play"></span> <span translate="">Play</span> <span class="jolticon-addon jolticon" ng-class="::\'jolticon-\' + ctrl.showcasedBrowserIcon"></span> </button> <button class="btn btn-success-outline btn-block-xs" ng-if="::ctrl.downloadableBuild" ng-click="ctrl.buildClick( ctrl.downloadableBuild )"> <span class="jolticon jolticon-download"></span> <span translate="">Download</span> <small ng-if="::ctrl.supportInfo[ ctrl.showcasedOs ].arch == \'64\'" translate="">64-bit</small> <small>({{ ::ctrl.downloadableBuild.primary_file.filesize | filesize }})</small> <span class="jolticon-addon jolticon" ng-class="::\'jolticon-\' + ctrl.showcasedOsIcon"></span> </button> <!--If this package only has "Other" builds, then we make it look like a download\n	button with a [...] after.\n	If the package has normal builds too, then we just show it as a more options sparse button.--> <button class="btn btn-block-xs" ng-if="::ctrl.extraBuilds.length" ng-class="{ \'btn-success-outline\': ctrl.otherOnly, \'btn-outline\': !ctrl.otherOnly }" gj-popover-trigger="game-package-card-more-options-{{ ctrl.package.id }}" gj-track-event="game-package-card:more-options"> <span class="jolticon jolticon-ellipsis-h"></span> <span ng-if="::ctrl.otherOnly"> <span class="jolticon jolticon-download"></span> <span translate="">Download</span> <span class="jolticon-addon jolticon jolticon-other-os"></span> </span> <span ng-if="::!ctrl.otherOnly" translate="">more</span> </button> <gj-popover popover-id="game-package-card-more-options-{{ ctrl.package.id }}"> <gj-game-package-card-more-options></gj-game-package-card-more-options> </gj-popover> '}}),angular.module("gj.Game.Package.Card").directive("gjGamePackageCard",["$timeout","$injector","gettextCatalog","Growls","Screen","Game","Game_Build","Game_PlayModal","Game_Downloader","Device","Environment","Analytics","currencyFilter",function(e,t,i,n,o,a,r,s,l,d,c,u,p){function h(e){var t=[];return e.os_windows&&t.push("windows"),e.os_windows_64&&!e.os_windows&&t.push("windows_64"),e.os_mac&&t.push("mac"),e.os_mac_64&&!e.os_mac&&t.push("mac_64"),e.os_linux&&t.push("linux"),e.os_linux_64&&!e.os_linux&&t.push("linux_64"),e.os_other&&t.push("other"),t}var m={windows:{icon:"windows",tooltip:i.getString("Windows Support"),sort:10},windows_64:{icon:"windows",tooltip:i.getString("Windows 64-bit Support"),arch:"64",sort:11},mac:{icon:"mac",tooltip:i.getString("Mac Support"),sort:20},mac_64:{icon:"mac",tooltip:i.getString("Mac 64-bit Support"),arch:"64",sort:21},linux:{icon:"linux",tooltip:i.getString("Linux Support"),sort:30},linux_64:{icon:"linux",tooltip:i.getString("Linux 64-bit Support"),arch:"64",sort:30},other:{icon:"other-os",tooltip:i.getString("Downloadable File"),sort:40},html:{icon:"html5",tooltip:i.getString("Web Playable"),sort:50},flash:{icon:"flash",tooltip:i.getString("Flash Web Playable"),sort:51},unity:{icon:"unity",tooltip:i.getString("Unity Web Playable"),sort:52},applet:{icon:"java",tooltip:i.getString("Java Applet Web Playable"),sort:53},silverlight:{icon:"silverlight",tooltip:i.getString("Silverlight Web Playable"),sort:54},rom:{icon:"rom",tooltip:i.getString("ROM"),sort:60}},g={};return g[r.EMULATOR_GB]=i.getString("Game Boy"),g[r.EMULATOR_GBC]=i.getString("Game Boy Color"),g[r.EMULATOR_GBA]=i.getString("Game Boy Advance"),g[r.EMULATOR_NES]=i.getString("NES"),g[r.EMULATOR_SNES]=i.getString("SNES"),g[r.EMULATOR_VBOY]=i.getString("Virtual Boy"),g[r.EMULATOR_GENESIS]=i.getString("Genesis/Mega Drive"),g[r.EMULATOR_ATARI2600]=i.getString("Atari 2600"),g[r.EMULATOR_ZX]=i.getString("ZX Spectrum"),g[r.EMULATOR_C64]=i.getString("Commodore 64"),g[r.EMULATOR_CPC]=i.getString("Amstrad CPC"),g[r.EMULATOR_MSX]=i.getString("MSX"),{restrict:"E",template:'<gj-card class="game-package-card" id="game-package-card-{{ ctrl.package.id }}"> <div class="game-package-card-pricing" ng-class="{ \'game-package-card-pricing-owned\': ctrl.isOwned }"> <!--If they own the package--> <div ng-if="ctrl.isOwned"> <strong> OWNED </strong> </div> <!--If they don\'t own the package yet.--> <div ng-if="!ctrl.isOwned" ng-switch="::ctrl.sellable.type"> <!--Fixed Pricing--> <div ng-switch-when="paid"> <span class="game-package-card-pricing-sale-percentage" ng-if="::ctrl.sale"> -{{ ::ctrl.salePercentageOff }}% </span> <strong class="game-package-card-pricing-amount"> {{ ::ctrl.integer( ctrl.pricing ) | currency:undefined:0 }}<span class="game-package-card-pricing-decimal">.{{ ::ctrl.decimal( ctrl.pricing ) }}</span> </strong> <span class="game-package-card-pricing-amount game-package-card-pricing-amount-old" ng-if="::ctrl.sale"> {{ ::ctrl.integer( ctrl.saleOldPricing ) | currency:undefined:0 }}<span class="game-package-card-pricing-decimal">.{{ ::ctrl.decimal( ctrl.saleOldPricing ) }}</span> </span> <br><span class="game-package-card-pricing-tag muted">or more</span> </div> <!--Pay What You Want--> <div ng-switch-when="pwyw"> <span class="game-package-card-pricing-tag"> name your price </span> </div> <!--Free/Default--> <div ng-switch-default=""> <strong class="game-package-card-pricing-amount"> FREE </strong> </div> </div> </div> <div class="card-title"> <h4> {{ ::(ctrl.package.title || ctrl.game.title) }} </h4> </div> <div class="card-meta card-meta-sm"> <!--In client, if the game is installed.--> <span ng-if="ctrl.localPackage"> <!--Reduce number of watches--> <span ng-if="ctrl.localPackage.isInstalling()"> <span ng-if="!ctrl.localPackage.isPatchPaused()"> <span class="tag tag-blue" ng-if="ctrl.localPackage.isInstalling()" translate="">INSTALLING</span> <span class="tag tag-pink" ng-if="ctrl.localPackage.didInstallFail()" translate="">INSTALL FAILED</span> </span> <span ng-if="ctrl.localPackage.isPatchPaused()"> <span class="tag" translate="">INSTALL PAUSED</span> </span> </span> <span ng-if="ctrl.localPackage.isUpdating()"> <span ng-if="!ctrl.localPackage.isPatchPaused()"> <span class="tag tag-blue" ng-if="ctrl.localPackage.isUpdating()" translate="">UPDATING</span> <span class="tag tag-pink" ng-if="ctrl.localPackage.didUpdateFail()" translate="">UPDATE FAILED</span> </span> <span ng-if="ctrl.localPackage.isPatchPaused()"> <span class="tag" translate="">UPDATE PAUSED</span> </span> </span> <span class="tag tag-active" ng-if="ctrl.localPackage.isSettled() && !ctrl.localPackage.isRunning()" translate="">INSTALLED</span> <span class="tag tag-active" ng-if="ctrl.localPackage.isRunning()" translate="">RUNNING</span> <span class="tag" ng-if="ctrl.localPackage.isRemoving()" translate="">REMOVING</span> <span class="dot-separator"></span> </span> <span ng-repeat="supportKey in ::ctrl.support" ng-class="::\'jolticon jolticon-\' + ctrl.supportInfo[ supportKey ].icon" tooltip="{{ ::ctrl.supportInfo[ supportKey ].tooltip }}"> </span> <span class="dot-separator" ng-if="ctrl.support.length"></span> <span ng-if="ctrl.showcasedRelease"> <span translate="">Version:</span> <strong>{{ ::ctrl.showcasedRelease.version_number }}</strong> <span class="dot-separator"></span> <span am-time-ago="::ctrl.showcasedRelease.published_on"></span> </span> </div> <div class="card-content card-sale-info" ng-if="::ctrl.sale"> <strong translate="">On sale!</strong> <span translate="">Offer ends in</span> <gj-countdown end="::ctrl.pricing.end"></gj-countdown> </div> <div class="card-content" ng-if="::ctrl.package.description"> <gj-fade-collapse fade-collapse-height="100" fade-collapse-is-open="ctrl.showFullDescription" fade-collapse-is-required="ctrl.canToggleDescription"> <div ng-bind-html="::ctrl.package.description | linky"></div> </gj-fade-collapse> <a class="hidden-text-expander" ng-if="::ctrl.canToggleDescription" ng-click="ctrl.showFullDescription = !ctrl.showFullDescription" gj-track-event="game-package-card:show-full-description"></a> </div> <div ng-if="::!ctrl.showcasedRelease"> <br> <div class="alert alert-warning" translate=""> No published releases yet. </div> </div> <div ng-if="ctrl.hasPaymentWell"> <div gj-expand-when="ctrl.isPaymentOpen" class="payment-well-expander"> <div class="payment-well"> <gj-game-package-card-payment-form game="::ctrl.game" package="::ctrl.package" sellable="::ctrl.sellable" pricing="::ctrl.pricing" partner-referred-key="::ctrl.partnerReferredKey" partner-referred-by="::ctrl.partnerReferredBy" partner-no-cut="::ctrl.partnerNoCut" on-bought="ctrl.onPackageBought()"> </gj-game-package-card-payment-form> <div ng-if="::ctrl.sellable.type == \'pwyw\'"> <hr> <span class="jolticon jolticon-chevron-right middle"></span> <a class="link-unstyled small" ng-click="ctrl.skipPayment()"> <span ng-if="::!Environment.isClient" translate="">No thanks, take to me to the download.</span> <span ng-if="::Environment.isClient" translate="">No thanks, just install it.</span> </a> </div> </div> </div> </div> <div class="card-controls" ng-if="::ctrl.showcasedRelease"> <div ng-if="ctrl.sellable.type != \'paid\' || ctrl.isOwned || ctrl.isPartner"> <!--The buttons are so different for client that we put them in a child component.\n				They will only be available on WTTF since they\'re pushed in the client component there.\'--> <div ng-if="::Environment.isClient"> <gj-client-package-card-buttons></gj-client-package-card-buttons> </div> <div ng-if="::!Environment.isClient"> <gj-game-package-card-buttons></gj-game-package-card-buttons> </div> <div ng-if="ctrl.isPartner && ctrl.sellable.type == \'paid\'"> <br> <div class="alert alert-success"> <span class="jolticon jolticon-check"></span> <span translate="">You get access to this package because you\'re a partner.</span> </div> <hr> </div> </div> <div ng-if="ctrl.sellable.type == \'paid\' && !ctrl.isOwned"> <!--Remove this as soon as we open the payment area.--> <div class="clearfix"> <button class="btn btn-success-outline btn-block-xs" ng-if="!ctrl.isPaymentOpen" ng-click="ctrl.isPaymentOpen = !ctrl.isPaymentOpen"> <span class="jolticon jolticon-heart"></span> Buy Now </button> <span class="game-package-card-payment-what-link"> (<a class="link-help" ng-click="ctrl.isWhatOpen = !ctrl.isWhatOpen" translate="">What do you get?</a>) </span> </div> </div> </div> <div gj-expand-when="ctrl.isWhatOpen" class="payment-well-expander payment-well-expander-files"> <div class="payment-well"> <div ng-repeat="build in ctrl.builds"> {{ ::build.primary_file.filename }} <small class="text-muted">({{ ::build.primary_file.filesize | filesize }})</small> <span ng-repeat="os in ::[ \'windows\', \'mac\', \'linux\', \'other\' ]"> <span ng-if="::build[ \'os_\' + os ] || build[ \'os_\' + os + \'_64\' ]" ng-class="::\'jolticon jolticon-\' + ctrl.supportInfo[ os ].icon" tooltip="{{ ::ctrl.supportInfo[ os ].tooltip }}"> </span> </span> </div> <br> <small translate="">And really warm feelings for supporting an indie developer!</small> </div> </div> </gj-card> ',
scope:{},bindToController:{game:"=game","package":"=gamePackage",sellable:"=?sellable",releases:"=gameReleases",builds:"=gameBuilds",key:"@?",isPartner:"=?",partnerReferredKey:"=?",partnerReferredBy:"=?",partnerNoCut:"=?"},controllerAs:"ctrl",controller:["$scope","$attrs","$parse",function(e,t,a){function p(e,t){var i=!1;f.extraBuilds.forEach(function(t){t.build.id==e.id&&(i=!0)}),i||f.extraBuilds.push({type:e.type,icon:f.supportInfo[t].icon,build:e,arch:f.supportInfo[t].arch||null,platform:t})}var f=this;if(e.Environment=c,e.Screen=o,e.Game_Build=r,this.showFullDescription=!1,this.canToggleDescription=void 0,this.emulatorInfo=g,this.supportInfo=angular.copy(m),this.support=[],this.downloadableBuild=null,this.browserBuild=null,this.extraBuilds=[],this.showcasedRelease=null,this.showcasedOs=null,this.showcasedOsIcon=null,this.showcasedBrowserIcon=null,this.otherOnly=!1,this.installedBuild=null,this.isOwned=this.sellable&&this.sellable.is_owned?!0:!1,this.isWhatOpen=!1,this.isPaymentOpen=!1,this.clickedBuild=null,this.key&&(this.isOwned=!0),this.sale=!1,this.salePercentageOff=0,this.saleOldPricing=void 0,this.sellable&&angular.isArray(this.sellable.pricings)&&(this.pricing=this.sellable.pricings[0],this.pricing.promotional&&(this.saleOldPricing=this.sellable.pricings[1],this.sale=!0,this.salePercentageOff=((this.saleOldPricing.amount-this.pricing.amount)/this.saleOldPricing.amount*100).toFixed(0))),this.hasPaymentWell=!1,!this.sellable||this.isOwned||"pwyw"!=this.sellable.type&&"paid"!=this.sellable.type||(this.hasPaymentWell=!0),e.$on("Game_Package_Card.showPaymentOptions",function(e,t){f["package"].id==t.id&&f.showPayment(f.downloadableBuild)}),this.builds){var v=d.os(),y=d.arch(),b={},w=[];this.builds.forEach(function(e){if(e.isBrowserBased())b[e.type]=e,this.support.push(e.type);else if(e.type==r.TYPE_ROM)b[e.type]=e,this.support.push(e.type),w.push(e);else if(e.os_other)w.push(e);else{var t=h(e);t.forEach(function(t){b[t]=e,this.support.push(this.supportInfo[t].icon)},this)}},this),this.support=_.uniq(this.support),this.supportInfo[v].sort=0,this.support.sort(function(e,t){return f.supportInfo[e].sort-f.supportInfo[t].sort});var j=["windows","windows_64","mac","mac_64","linux","linux_64"];"64"==y?(j.unshift(v),j.unshift(v+"_64")):(j.unshift(v+"_64"),j.unshift(v)),j.every(function(e){return b[e]?(this.downloadableBuild=b[e],this.showcasedOs=e,void(this.showcasedOsIcon=f.supportInfo[e].icon)):!0},this),["html","flash","unity","applet","silverlight","rom"].every(function(e){return b[e]?(this.browserBuild=b[e],void(this.showcasedBrowserIcon=f.supportInfo[e].icon)):!0},this),this.downloadableBuild&&(this.showcasedRelease=this.downloadableBuild._release),this.browserBuild&&(!this.showcasedRelease||this.browserBuild._release.sort<this.showcasedRelease)&&(this.showcasedRelease=this.browserBuild._release),angular.forEach(b,function(e,t){(e!=f.downloadableBuild||t!=f.showcasedOs)&&(e.type!=r.TYPE_DOWNLOADABLE&&f.browserBuild&&f.browserBuild.id==e.id||p(e,t))}),w.length&&w.forEach(function(e){var t="other";e.type==r.TYPE_ROM&&(t="rom"),p(e,t)}),this.extraBuilds.length&&this.extraBuilds.sort(function(e,t){return f.supportInfo[e.platform].sort-f.supportInfo[t.platform].sort}),this.downloadableBuild||this.browserBuild||!w.length||(this.otherOnly=!0,this.showcasedRelease=this.releases[0])}this.buildClick=function(e,t){c.isClient&&t?this._doBuildClick(e,t):"pwyw"==this.sellable.type&&this.showPayment(e)||this._doBuildClick(e,t)},this._doBuildClick=function(e,t){var i=e.type==r.TYPE_DOWNLOADABLE?"download":"play";e.type==r.TYPE_ROM&&t&&(i="download"),"download"==i?this._download(e):"play"==i&&this._showBrowserModal(e)},this.showPayment=function(e){return this.hasPaymentWell&&!this.isPaymentOpen?(this.isPaymentOpen=!0,this.clickedBuild=e,!0):!1},this.skipPayment=function(){c.isClient?this.startInstall(this.clickedBuild):this.buildClick(this.clickedBuild)},this._download=function(e){u.trackEvent("game-package-card","download","download"),l.download(this.game,e,{isOwned:this.sellable&&this.isOwned||this.isPartner,key:this.key})},this._showBrowserModal=function(e){u.trackEvent("game-package-card","download","play"),s.show(this.game,e,{isOwned:this.sellable&&this.isOwned||this.isPartner,key:this.key})},this.integer=function(e){return Math.floor(e.amount/100)},this.decimal=function(e){var t=e.amount;return t%=100,10>t&&(t+="0"),""+t},this.onPackageBought=function(){this.isWhatOpen=!1,this.isPaymentOpen=!1,this.hasPaymentWell=!1,this.isOwned=!0,n.success({title:i.getString("Order Complete"),message:i.getString("Warm thanks from both {{ developer }} and the Game Jolt team.",{developer:this.game.developer.display_name}),sticky:!0})}}]}}]),angular.module("gj.Game.Package.Card").directive("gjGamePackageCardMoreOptions",function(){return{restrict:"E",require:"^gjGamePackageCard",scope:!0,template:'<div class="list-group list-group-dark nowrap"> <a class="list-group-item has-icon" ng-repeat="extraBuild in ::ctrl.extraBuilds track by extraBuild.icon + \'-\' + extraBuild.build.id" ng-click="ctrl.buildClick( extraBuild.build, true )" gj-track-event="game-package-card:more-options:click-option"> <span ng-class="::\'jolticon jolticon-\' + extraBuild.icon"></span> <!--We show the filename if it\'s an "Other" build.--> <span ng-if="::!extraBuild.build.os_other" ng-switch="::extraBuild.build.type"> <span ng-switch-when="downloadable" translate=""> Download </span> <span ng-switch-when="rom" translate="" translate-params-platform="ctrl.emulatorInfo[ extraBuild.build.emulator_type ]" translate-comment="{{ platform }} will be the platform we are downloading for, such as Game Boy, NES, etc."> Download {{ platform }} ROM </span> <span ng-switch-default="" translate=""> Play </span> </span> <span ng-if="::extraBuild.build.os_other"> {{ ::extraBuild.build.primary_file.filename }} </span> <small ng-if="::extraBuild.arch == \'64\'" translate="">64-bit</small> <small class="text-muted">({{ ::extraBuild.build.primary_file.filesize | filesize }})</small> <!--If the version is different than the main release, then show it.--> <span class="tiny" ng-if="::extraBuild.build.game_release_id != ctrl.showcasedRelease.id"> <em>v{{ ::extraBuild.build._release.version_number }}</em> </span> <small class="text-muted" ng-if="Environment.isClient && extraBuild.type != \'html\'"> <br> <em translate="">(will open in browser)</em> </small> </a> </div> '}}),angular.module("gj.Game.Package.Card").directive("gjGamePackageCardPaymentForm",["$window","$state","App","Screen","Form","Environment","Api","Geo","Sellable","Order_Payment","Growls","Device","HistoryTick","gjCurrencyFilter","gettextCatalog",function(e,t,i,n,o,a,r,s,l,d,c,u,p,h,m){var g=new o({template:"/lib/gj-lib-client/components/game/package/card/payment-form.html"});return g.scope.game="=",g.scope["package"]="=",g.scope.sellable="=",g.scope.pricing="=",g.scope.partnerReferredKey="=?",g.scope.partnerReferredBy="=?",g.scope.partnerNoCut="=?",g.scope.onBought="&",g.onInit=function(e){function o(){r.sendRequest("/web/checkout/methods?amount="+100*e.formModel.amount,null,{detach:!0}).then(function(t){e.formState.isLoadingMethods=!1,e.formState.isLoaded=!0,e.minOrderAmount=t.minOrderAmount||50,t&&t.cards&&t.cards.length&&(e.cards=t.cards,e.cardsTax=_.indexBy(t.cardsTax,"id")),t&&t.billingAddresses&&t.billingAddresses.length&&(e.addresses=t.billingAddresses),t&&t.walletBalance&&t.walletBalance>0&&(e.walletBalance=t.walletBalance,e.walletTax=t.walletTax)})}function a(t){e.paymentForm.amount.$valid&&(e.formModel.amount+=t)}function d(){if(!e.formModel.amount||e.formModel.amount<=0)return!0;var t="address"==e.formState.checkoutStep?e.formState.addressTaxAmount:e.walletTax,i=e.pricing.amount,n=100*e.formModel.amount;return e.sellable.type==l.TYPE_PAID&&e.walletBalance<i+t?!1:e.walletBalance<n+t?!1:!0}function g(t){if(e.addresses.length){if("paypal"==t)return void y();if("wallet"==t)return void j()}e.formState.checkoutStep="address",e.formState.checkoutType=t,e.formState.countries=s.getCountries(),e.formState.calculatedAddressTax=!1,e.formState.addressTaxAmount=0}function f(){if(e.formState.calculatedAddressTax=!1,e.formModel.country&&e.formModel.region){var t={amount:100*e.formModel.amount,country:e.formModel.country,region:e.formModel.region};return r.sendRequest("/web/checkout/taxes",t,{detach:!0}).then(function(t){e.formState.calculatedAddressTax=!0,e.formState.addressTaxAmount=t.amount})}}function v(){e.formState.checkoutType="cc-stripe",e.onSubmit()}function y(){e.formState.checkoutType="paypal",e.onSubmit()}function b(){e.formState.checkoutStep="primary"}function w(t){var i={payment_method:"cc-stripe",sellable_id:e.sellable.id,pricing_id:e.pricing.id,amount:100*e.formModel.amount};return $(i,{payment_source:t.id})}function j(){var t={payment_method:"wallet",sellable_id:e.sellable.id,pricing_id:e.pricing.id,amount:100*e.formModel.amount};return e.addresses.length?t.address_id=e.addresses[0].id:(t.country=e.formModel.country,t.street1=e.formModel.street1,t.region=e.formModel.region,t.postcode=e.formModel.postcode),$(t,{wallet:!0})}function $(t,i){return e.formState.isLoadingMethods||e.formState.isProcessing?void 0:(e.formState.isProcessing=!0,t.source=p.getSource("Game",e["package"].game_id)||null,t.os=u.os(),t.arch=u.arch(),t.ref=e.partnerReferredKey||null,r.sendRequest("/web/checkout/setup-order",t).then(function(e){return e.success===!1?$q.reject():r.sendRequest("/web/checkout/charge/"+e.cart.id,i)}).then(function(t){return t.success===!1?$q.reject():void e.onBought({})})["catch"](function(){e.formState.isProcessing=!1,c.error({sticky:!0,message:m.getString("There was a problem processing your payment method.")})}))}e.$state=t,e.Screen=n,e.App=i,e.gjCurrencyFilter=h,e.formState.isLoaded=!1,e.formState.isLoadingMethods=!0,e.formState.checkoutType="cc-stripe",e.formState.checkoutStep="primary",e.formModel.amount=e.pricing.amount?e.pricing.amount/100:null,e.formModel.country="us",e.cards=[],e.cardsTax={},e.addresses=[],e.walletBalance=0,e.walletTax=0,e.addMoney=a,e.collectAddress=g,e.checkoutCard=v,e.checkoutPaypal=y,e.startOver=b,e.checkoutSavedCard=w,e.checkoutWallet=j,e.hasSufficientWalletFunds=d,o(),e.$watch("formModel.country",function(t){e.formState.regions=s.getRegions(t),e.formModel.region=e.formState.regions?e.formState.regions[0].code:""});var S=_.debounce(o,1e3);e.$watch("formModel.amount",function(t,i){t!=i&&(e.formState.isLoadingMethods=!0,S())}),e.$watchGroup(["formModel.country","formModel.region"],f)},g.onSubmit=function(t){var n={payment_method:t.formState.checkoutType,sellable_id:t.sellable.id,pricing_id:t.pricing.id,amount:100*t.formModel.amount,country:t.formModel.country,street1:t.formModel.street1,region:t.formModel.region,postcode:t.formModel.postcode};return i.user||(n.email_address=t.formModel.email_address),t.addresses.length&&(n.address_id=t.addresses[0].id),n.source=p.getSource("Game",t["package"].game_id)||null,n.os=u.os(),n.arch=u.arch(),n.ref=t.partnerReferredKey||null,r.sendRequest("/web/checkout/setup-order",n).then(function(t){return t.success!==!1&&(a.isClient?n.payment_method==d.METHOD_CC_STRIPE?e.location.href=a.checkoutBaseUrl+"/checkout/"+t.cart.id:require("nw.gui").Shell.openExternal(t.redirectUrl):e.location.href=t.redirectUrl),t})},g}]),angular.module("gj.Currency",[]),angular.module("gj.Currency").filter("gjCurrency",["currencyFilter",function(e){return function(t,i){return t%100==0?e(t/100,i,0):e(t/100,i)}}]),angular.module("gj.Time",[]),angular.module("gj.Time").filter("time",function(){return function(e){if(angular.isDefined(e)){var t=Math.floor(e/60),i=Math.floor(e%60);return 10>i&&(i="0"+i),t+":"+i}return""}}),angular.module("gj.Ad",["gj.Time"]),angular.module("gj.Ad").directive("gjAd",["$timeout","$window","$document","$interpolate","$parse","Ads","Environment",function(e,t,i,n,o,a,r){function s(){if(!a.isBootstrapped){a.isBootstrapped=!0;var e=i[0];t.googletag={},t.googletag.cmd=t.googletag.cmd||[],function(){var t=null;(t=e.getElementById("ads-script-bootsrapper"))&&t.parentNode.removeChild(t);var i=e.createElement("script");i.id="ads-script-bootsrapper",i.async=!0,i.type="text/javascript",i.src="https://www.googletagservices.com/tag/js/gpt.js";var n=e.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}(),t.googletag.cmd.push(function(){t.googletag.defineSlot("/27005478/web-display-leaderboard",[[728,90],[970,90]],"div-gpt-ad-"+d+"-10").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-leaderboard",[[728,90],[970,90]],"div-gpt-ad-"+d+"-11").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-leaderboard",[[728,90],[970,90]],"div-gpt-ad-"+d+"-12").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-leaderboard",[[728,90],[970,90]],"div-gpt-ad-"+d+"-13").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-rectangle",[[300,250],[300,600]],"div-gpt-ad-"+d+"-20").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-rectangle",[[300,250],[300,600]],"div-gpt-ad-"+d+"-21").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-160x600",[160,600],"div-gpt-ad-"+d+"-30").addService(googletag.pubads()),t.googletag.defineSlot("/27005478/web-display-160x600",[160,600],"div-gpt-ad-"+d+"-31").addService(googletag.pubads()),t.googletag.enableServices()})}}function l(){a.isBootstrapped=!1}var d="1437670388518";return{restrict:"E",template:"<div class=\"ad\" ng-class=\"::{ 'ad-leaderboard': adSize == 'leaderboard', 'ad-rectangle': adSize == 'rectangle', 'ad-skyscraper': adSize == 'skyscraper' }\"> <div class=\"ad-inner\"></div> </div> ",scope:{},compile:function(e,t){var c=n(t.adSize),u=t.adResource?n(t.adResource):void 0,p=t.adResourceId?o(t.adResourceId):void 0;return{pre:function(e,t,i){e.adSize=c(e.$parent),e.adId=0,e.globalTagId=d,++a.numActive;var n=null,o=null;u&&p&&(n=u(e.$parent),o=p(e.$parent)),a.sendBeacon(a.TYPE_DISPLAY,n,o),"leaderboard"==e.adSize?(e.adId=10+a.numLeaderboards,++a.numLeaderboards):"rectangle"==e.adSize?(e.adId=20+a.numRectangles,++a.numRectangles):"skyscraper"==e.adSize&&(e.adId=30+a.numSkyscrapers,++a.numSkyscrapers),e.$on("$destroy",function(){--a.numActive,"leaderboard"==e.adSize?--a.numLeaderboards:"rectangle"==e.adSize?--a.numRectangles:"skyscraper"==e.adSize&&--a.numSkyscrapers,a.numActive<=0&&l()})},post:function(e,t){if(!r.isPrerender){var n=t[0].getElementsByClassName("ad-inner")[0],o=i[0].createElement("div");if(o.id="div-gpt-ad-"+e.globalTagId+"-"+e.adId,n.appendChild(o),"production"==r.env&&!r.isClient){s();var a=i[0].createElement("script");a.type="text/javascript",a.text="googletag.cmd.push(function() { googletag.display('div-gpt-ad-"+e.globalTagId+"-"+e.adId+"'); });",o.appendChild(a)}}}}}}}]),angular.module("gj.Ad").service("Ads",["$document","Environment",function(e,t){this.TYPE_DISPLAY="display",this.TYPE_VIDEO="video",this.RESOURCE_TYPE_NONE=1,this.RESOURCE_TYPE_GAME=2,this.RESOURCE_TYPE_USER=3,this.RESOURCE_TYPE_FIRESIDE_POST=4,this.isBootstrapped=!1,this.numActive=0,this.numLeaderboards=0,this.numRectangles=0,this.numSkyscrapers=0,this.sendBeacon=function(i,n,o){if(!t.isPrerender){var a="";a+="cb="+Date.now(),n&&("Game"==n?(a+="&resource_type="+this.RESOURCE_TYPE_GAME,a+="&resource_id="+o):"User"==n?(a+="&resource_type="+this.RESOURCE_TYPE_USER,a+="&resource_id="+o):"Fireside_Post"==n&&(a+="&resource_type="+this.RESOURCE_TYPE_FIRESIDE_POST,a+="&resource_id="+o));var r=e[0].createElement("img");r.src=t.apiHost+"/adserver/log/"+i+"?"+a}}}]),angular.module("gj.Game.Downloader",["gj.Analytics","gj.HistoryTick","gj.Popover"]),angular.module("gj.Game.Downloader").service("Game_Downloader",["$rootScope","$window","$state","Environment","HistoryTick","Popover","Analytics","Growls","gettextCatalog",function(e,t,i,n,o,a,r,s,l){var d,c=!1;e.$on("$stateChangeStart",function(){c=!1}),this.download=function(e,c,u){if(u=u||{},r.trackEvent("game-play","download"),n.isClient){var p=require("nw.gui");p.Shell.openExternal(n.baseUrl+i.href("discover.games.view.download.build",{slug:e.slug,id:e.id,buildId:c.id})),a.hideAll()}else if(e.bundle_only||u.key||u.isOwned||c._package._sellable&&c._package._sellable.is_owned){if(d)return;var h=!0,m=null;d=c.getDownloadUrl({key:u.key||null}).then(function(t){return m=t.downloadUrl,o.sendBeacon("game-build",c.id,{sourceResource:"Game",sourceResourceId:e.id,key:u.key||null})}).then(function(){h&&(t.location=m),d=null})["catch"](function(e){s.error(l.getString("Could not get download URL.")),d=null})}else i.go("discover.games.view.download.build",{slug:e.slug,id:e.id,buildId:c.id})}}]),angular.module("gj.Device",[]),angular.module("gj.Device").service("Device",["$window","Environment",function(e,t){this._result=void 0,this._os=void 0,this._arch=void 0;var i=["windows","windows phone","windows mobile"],n=["mac os"],o=["linux","arch","centos","fedora","debian","gentoo","gnu","mageia","mandriva","mint","pclinuxos","redhat","slackware","suse","ubuntu","unix","vectorlinux","freebsd","netbsd","openbsd"],a=["68k","arm","avr","ia32","irix","mips","pa-risc","ppc","sparc"],r=["amd64","arm64","ia64","irix64","mips64","sparc64"];this._getResult=function(){if(!this._result){if(!e.UAParser)throw new Error("Could not find UAParser globally.");var t=new e.UAParser;this._result=t.getResult()}return this._result};var i=["windows","windows phone","windows mobile"],n=["mac os"],o=["linux","arch","centos","fedora","debian","gentoo","gnu","mageia","mandriva","mint","pclinuxos","redhat","slackware","suse","ubuntu","unix","vectorlinux","freebsd","netbsd","openbsd"];this.os=function(){if(t.isClient){var e=require("os"),a=e.type();return"Linux"==a?"linux":"Darwin"==a?"mac":"Windows_NT"==a?"windows":"other"}if(!this._os){var r=this._getResult(),s=r.os.name.toLowerCase();this._os=-1!==i.indexOf(s)?"windows":-1!==n.indexOf(s)?"mac":-1!==o.indexOf(s)?"linux":"other"}return this._os},this.arch=function(){if(t.isClient){var e=require("os").arch();if("windows"==this.os())return"x64"==e||process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"64":"32";if("x64"==e)return"64";if("ia32"==e)return"32"}if(angular.isUndefined(this._arch)){var i=this._getResult(),e=i.cpu&&i.cpu.architecture?i.cpu.architecture.toLowerCase():null;this._arch=-1!==r.indexOf(e)?"64":-1!==a.indexOf(e)?"32":null}return this._arch}}]),angular.module("gj.Filesize",[]),angular.module("gj.Filesize").filter("filesize",["numberFilter",function(e){var t=["bytes","KB","MB","GB","TB","PB"];return function(i,n){if(isNaN(parseFloat(i))||!isFinite(i))return"?";if(1024>i)return i+" "+t[0];for(var o=0;i>=1024;)i/=1024,++o;return e(i.toFixed(n))+" "+t[o]}}]);
//# sourceMappingURL=app.js.map